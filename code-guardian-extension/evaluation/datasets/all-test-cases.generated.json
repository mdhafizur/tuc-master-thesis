[
  {
    "id": "owasp_bench_sql_concat",
    "name": "SQL Injection - SQL injection via string concatenation (OWASP Benchmark)",
    "code": "// OWASP Benchmark: SQL injection via concatenation\nconst sqlite3 = require('sqlite3').verbose();\n\nfunction searchProducts(searchTerm) {\n    const db = new sqlite3.Database('products.db');\n    \n    // Vulnerable: Direct string concatenation\n    const query = \"SELECT * FROM products WHERE name LIKE '%\" + searchTerm + \"%'\";\n    \n    return new Promise((resolve, reject) => {\n        db.all(query, [], (err, rows) => {\n            if (err) reject(err);\n            else resolve(rows);\n        });\n    });\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "SQL Injection",
        "cwe": "CWE-89",
        "severity": "high",
        "description": "SQL injection via string concatenation (OWASP Benchmark)"
      }
    ],
    "expectedFix": "Use parameterized SQL queries or prepared statements.",
    "metadata": {
      "sourceDataset": "benchmark",
      "sourcePolicy": "all",
      "source": "OWASP Benchmark SQL-01",
      "originalId": "owasp_bench_sql_concat",
      "vulnerableLines": [
        7
      ],
      "provenance": {
        "sourceType": "owasp-benchmark",
        "referenceId": "OWASP Benchmark SQL-01",
        "sourceUrl": "https://github.com/OWASP-Benchmark/Benchmark",
        "sourceLabel": "OWASP Benchmark SQL-01",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "owasp_bench_sql_template",
    "name": "SQL Injection - SQL injection via template literals (OWASP Benchmark)",
    "code": "// OWASP Benchmark: SQL injection via template literals\nconst mysql = require('mysql');\n\nfunction loginUser(username, password) {\n    const connection = mysql.createConnection(dbConfig);\n    \n    // Vulnerable: Template literal without escaping\n    const sql = `SELECT id, role FROM users WHERE username='${username}' AND password='${password}'`;\n    \n    return new Promise((resolve, reject) => {\n        connection.query(sql, (error, results) => {\n            if (error) reject(error);\n            resolve(results[0] || null);\n        });\n    });\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "SQL Injection",
        "cwe": "CWE-89",
        "severity": "high",
        "description": "SQL injection via template literals (OWASP Benchmark)"
      }
    ],
    "expectedFix": "Use parameterized SQL queries or prepared statements.",
    "metadata": {
      "sourceDataset": "benchmark",
      "sourcePolicy": "all",
      "source": "OWASP Benchmark SQL-02",
      "originalId": "owasp_bench_sql_template",
      "vulnerableLines": [
        7
      ],
      "provenance": {
        "sourceType": "owasp-benchmark",
        "referenceId": "OWASP Benchmark SQL-02",
        "sourceUrl": "https://github.com/OWASP-Benchmark/Benchmark",
        "sourceLabel": "OWASP Benchmark SQL-02",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "owasp_bench_xss_innerHTML",
    "name": "Cross-Site Scripting (XSS) - XSS via innerHTML assignment (OWASP Benchmark)",
    "code": "// OWASP Benchmark: XSS via innerHTML\nfunction displayUserProfile(userName, userBio) {\n    const profileContainer = document.getElementById('profileContainer');\n    \n    // Vulnerable: Unescaped template literal in innerHTML\n    const profileHtml = `\n        <div class=\"profile\">\n            <h2>Profile: ${userName}</h2>\n            <div class=\"bio\">${userBio}</div>\n        </div>\n    `;\n    \n    profileContainer.innerHTML = profileHtml;\n}\n\nfunction showAlert(message) {\n    // Vulnerable: Direct innerHTML assignment\n    document.getElementById('alerts').innerHTML = \"<div class='alert'>\" + message + \"</div>\";\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Cross-Site Scripting (XSS)",
        "cwe": "CWE-79",
        "severity": "high",
        "description": "XSS via innerHTML assignment (OWASP Benchmark)"
      }
    ],
    "expectedFix": "Escape/sanitize untrusted content and avoid unsafe DOM sinks.",
    "metadata": {
      "sourceDataset": "benchmark",
      "sourcePolicy": "all",
      "source": "OWASP Benchmark XSS-01",
      "originalId": "owasp_bench_xss_innerHTML",
      "vulnerableLines": [
        11,
        16
      ],
      "provenance": {
        "sourceType": "owasp-benchmark",
        "referenceId": "OWASP Benchmark XSS-01",
        "sourceUrl": "https://github.com/OWASP-Benchmark/Benchmark",
        "sourceLabel": "OWASP Benchmark XSS-01",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "owasp_bench_xss_document_write",
    "name": "Cross-Site Scripting (XSS) - XSS via document.write (OWASP Benchmark)",
    "code": "// OWASP Benchmark: XSS via document.write\nfunction renderPage(title, content) {\n    // Vulnerable: Unescaped content in document.write\n    document.write(`\n        <html>\n            <head><title>${title}</title></head>\n            <body>\n                <h1>${title}</h1>\n                <div>${content}</div>\n            </body>\n        </html>\n    `);\n}\n\nfunction insertScript(scriptContent) {\n    // Vulnerable: Direct script injection\n    document.write(\"<script>\" + scriptContent + \"</script>\");\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Cross-Site Scripting (XSS)",
        "cwe": "CWE-79",
        "severity": "high",
        "description": "XSS via document.write (OWASP Benchmark)"
      }
    ],
    "expectedFix": "Escape/sanitize untrusted content and avoid unsafe DOM sinks.",
    "metadata": {
      "sourceDataset": "benchmark",
      "sourcePolicy": "all",
      "source": "OWASP Benchmark XSS-02",
      "originalId": "owasp_bench_xss_document_write",
      "vulnerableLines": [
        3,
        15
      ],
      "provenance": {
        "sourceType": "owasp-benchmark",
        "referenceId": "OWASP Benchmark XSS-02",
        "sourceUrl": "https://github.com/OWASP-Benchmark/Benchmark",
        "sourceLabel": "OWASP Benchmark XSS-02",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "owasp_bench_cmd_exec",
    "name": "Command Injection - Command injection via exec (OWASP Benchmark)",
    "code": "// OWASP Benchmark: Command injection\nconst { exec } = require('child_process');\n\nfunction analyzeFile(filename) {\n    // Vulnerable: Unvalidated filename in command\n    const command = `file ${filename}`;\n    \n    return new Promise((resolve, reject) => {\n        exec(command, (error, stdout, stderr) => {\n            if (error) reject(error);\n            else resolve(stdout);\n        });\n    });\n}\n\nfunction compressFile(inputFile, outputFile) {\n    // Vulnerable: Multiple injection points\n    exec(`gzip -c ${inputFile} > ${outputFile}`, (error, stdout) => {\n        console.log('Compression complete');\n    });\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Command Injection",
        "cwe": "CWE-78",
        "severity": "high",
        "description": "Command injection via exec (OWASP Benchmark)"
      }
    ],
    "expectedFix": "Use safe process APIs and never concatenate untrusted input into commands.",
    "metadata": {
      "sourceDataset": "benchmark",
      "sourcePolicy": "all",
      "source": "OWASP Benchmark CMD-01",
      "originalId": "owasp_bench_cmd_exec",
      "vulnerableLines": [
        6,
        16
      ],
      "provenance": {
        "sourceType": "owasp-benchmark",
        "referenceId": "OWASP Benchmark CMD-01",
        "sourceUrl": "https://github.com/OWASP-Benchmark/Benchmark",
        "sourceLabel": "OWASP Benchmark CMD-01",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "owasp_bench_path_traversal",
    "name": "Path Traversal - Path traversal in file serving (OWASP Benchmark)",
    "code": "// OWASP Benchmark: Path traversal\nconst fs = require('fs');\nconst express = require('express');\nconst app = express();\n\napp.get('/files/:filename', (req, res) => {\n    const filename = req.params.filename;\n    \n    // Vulnerable: No path validation\n    const filepath = './uploads/' + filename;\n    \n    try {\n        const content = fs.readFileSync(filepath, 'utf8');\n        res.send(content);\n    } catch (error) {\n        res.status(404).send('File not found');\n    }\n});\n\nfunction readConfigFile(configName) {\n    // Vulnerable: Path traversal in config reading\n    const configPath = './config/' + configName + '.json';\n    return JSON.parse(fs.readFileSync(configPath, 'utf8'));\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Path Traversal",
        "cwe": "CWE-22",
        "severity": "high",
        "description": "Path traversal in file serving (OWASP Benchmark)"
      }
    ],
    "expectedFix": "Canonicalize paths and restrict access to approved directories.",
    "metadata": {
      "sourceDataset": "benchmark",
      "sourcePolicy": "all",
      "source": "OWASP Benchmark PATH-01",
      "originalId": "owasp_bench_path_traversal",
      "vulnerableLines": [
        9,
        20
      ],
      "provenance": {
        "sourceType": "owasp-benchmark",
        "referenceId": "OWASP Benchmark PATH-01",
        "sourceUrl": "https://github.com/OWASP-Benchmark/Benchmark",
        "sourceLabel": "OWASP Benchmark PATH-01",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "owasp_bench_weak_crypto",
    "name": "Weak Cryptography - Weak cryptographic algorithms (OWASP Benchmark)",
    "code": "// OWASP Benchmark: Weak cryptography\nconst crypto = require('crypto');\n\nfunction hashPassword(password) {\n    // Vulnerable: Using weak MD5 algorithm\n    return crypto.createHash('md5').update(password).digest('hex');\n}\n\nfunction encryptData(data, key) {\n    // Vulnerable: Using DES encryption\n    const cipher = crypto.createCipher('des', key);\n    let encrypted = cipher.update(data, 'utf8', 'hex');\n    encrypted += cipher.final('hex');\n    return encrypted;\n}\n\nfunction generateToken() {\n    // Vulnerable: Weak random number generation\n    return Math.random().toString(36).substring(2, 15);\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Weak Cryptography",
        "cwe": "CWE-327",
        "severity": "medium",
        "description": "Weak cryptographic algorithms (OWASP Benchmark)"
      }
    ],
    "expectedFix": "Use strong algorithms and secure key generation/management.",
    "metadata": {
      "sourceDataset": "benchmark",
      "sourcePolicy": "all",
      "source": "OWASP Benchmark CRYPTO-01",
      "originalId": "owasp_bench_weak_crypto",
      "vulnerableLines": [
        5,
        10,
        17
      ],
      "provenance": {
        "sourceType": "owasp-benchmark",
        "referenceId": "OWASP Benchmark CRYPTO-01",
        "sourceUrl": "https://github.com/OWASP-Benchmark/Benchmark",
        "sourceLabel": "OWASP Benchmark CRYPTO-01",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "owasp_bench_ldap_injection",
    "name": "LDAP Injection - LDAP injection vulnerability (OWASP Benchmark)",
    "code": "// OWASP Benchmark: LDAP injection\nconst ldap = require('ldapjs');\n\nfunction authenticateUser(username, password) {\n    const client = ldap.createClient({\n        url: 'ldap://localhost:389'\n    });\n    \n    // Vulnerable: Unescaped LDAP filter\n    const filter = `(&(uid=${username})(userPassword=${password}))`;\n    \n    const searchOptions = {\n        filter: filter,\n        scope: 'sub'\n    };\n    \n    client.search('dc=example,dc=com', searchOptions, (err, result) => {\n        if (err) throw err;\n        // Process results\n    });\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "LDAP Injection",
        "cwe": "CWE-90",
        "severity": "high",
        "description": "LDAP injection vulnerability (OWASP Benchmark)"
      }
    ],
    "expectedFix": "Use parameterized LDAP queries and sanitize user-controlled input.",
    "metadata": {
      "sourceDataset": "benchmark",
      "sourcePolicy": "all",
      "source": "OWASP Benchmark LDAP-01",
      "originalId": "owasp_bench_ldap_injection",
      "vulnerableLines": [
        10
      ],
      "provenance": {
        "sourceType": "owasp-benchmark",
        "referenceId": "OWASP Benchmark LDAP-01",
        "sourceUrl": "https://github.com/OWASP-Benchmark/Benchmark",
        "sourceLabel": "OWASP Benchmark LDAP-01",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "owasp_bench_header_injection",
    "name": "Header Injection - HTTP header injection (OWASP Benchmark)",
    "code": "// OWASP Benchmark: HTTP header injection\nconst express = require('express');\nconst app = express();\n\napp.get('/redirect', (req, res) => {\n    const target = req.query.url;\n    \n    // Vulnerable: Unvalidated redirect URL\n    res.redirect(target);\n});\n\napp.get('/cookie', (req, res) => {\n    const value = req.query.value;\n    \n    // Vulnerable: Unvalidated cookie value\n    res.setHeader('Set-Cookie', `userdata=${value}`);\n    res.send('Cookie set');\n});\n\nfunction setCustomHeader(response, headerValue) {\n    // Vulnerable: Header injection\n    response.setHeader('X-Custom-Header', headerValue);\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Header Injection",
        "cwe": "CWE-113",
        "severity": "medium",
        "description": "HTTP header injection (OWASP Benchmark)"
      }
    ],
    "expectedFix": "Sanitize header values and enforce strict header construction.",
    "metadata": {
      "sourceDataset": "benchmark",
      "sourcePolicy": "all",
      "source": "OWASP Benchmark HEADER-01",
      "originalId": "owasp_bench_header_injection",
      "vulnerableLines": [
        8,
        15,
        21
      ],
      "provenance": {
        "sourceType": "owasp-benchmark",
        "referenceId": "OWASP Benchmark HEADER-01",
        "sourceUrl": "https://github.com/OWASP-Benchmark/Benchmark",
        "sourceLabel": "OWASP Benchmark HEADER-01",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "nodejs_cve_2021_23337",
    "name": "Prototype Pollution - Prototype pollution in lodash merge function",
    "code": "// CVE-2021-23337: Prototype pollution in lodash\nconst _ = require('lodash');\n\nfunction mergeUserSettings(defaultSettings, userPreferences) {\n    // Vulnerable: lodash.merge susceptible to prototype pollution\n    return _.merge({}, defaultSettings, userPreferences);\n}\n\nfunction updateUserConfig(userId, configData) {\n    const defaults = {\n        theme: 'light',\n        notifications: true,\n        language: 'en'\n    };\n    \n    // Parse user input (potentially malicious)\n    const userConfig = JSON.parse(configData);\n    \n    // This can pollute Object.prototype if userConfig contains __proto__\n    const mergedConfig = mergeUserSettings(defaults, userConfig);\n    \n    return mergedConfig;\n}\n\n// Attack payload example:\n// {\"__proto__\": {\"polluted\": true}}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Prototype Pollution",
        "cwe": "CWE-1321",
        "severity": "high",
        "description": "Prototype pollution in lodash merge function"
      }
    ],
    "expectedFix": "Block dangerous keys and clone/validate objects before merge operations.",
    "metadata": {
      "sourceDataset": "benchmark",
      "sourcePolicy": "all",
      "source": "CVE-2021-23337",
      "originalId": "nodejs_cve_2021_23337",
      "vulnerableLines": [
        5
      ],
      "provenance": {
        "sourceType": "cve",
        "referenceId": "CVE-2021-23337",
        "sourceUrl": "https://nvd.nist.gov/vuln/detail/CVE-2021-23337",
        "sourceLabel": "CVE-2021-23337",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "nodejs_cve_2022_24999",
    "name": "Path Traversal - Path traversal in express static file serving",
    "code": "// CVE-2022-24999: Path traversal in express static\nconst express = require('express');\nconst path = require('path');\nconst fs = require('fs');\n\nconst app = express();\n\n// Vulnerable static file serving implementation\napp.get('/files/:filename', (req, res) => {\n    const filename = req.params.filename;\n    const filePath = path.join(__dirname, 'public', filename);\n    \n    // Vulnerable: No validation of path traversal\n    if (fs.existsSync(filePath)) {\n        res.sendFile(filePath);\n    } else {\n        res.status(404).send('File not found');\n    }\n});\n\n// Attack example: GET /files/../../../etc/passwd",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Path Traversal",
        "cwe": "CWE-22",
        "severity": "high",
        "description": "Path traversal in express static file serving"
      }
    ],
    "expectedFix": "Canonicalize paths and restrict access to approved directories.",
    "metadata": {
      "sourceDataset": "benchmark",
      "sourcePolicy": "all",
      "source": "CVE-2022-24999",
      "originalId": "nodejs_cve_2022_24999",
      "vulnerableLines": [
        10
      ],
      "provenance": {
        "sourceType": "cve",
        "referenceId": "CVE-2022-24999",
        "sourceUrl": "https://nvd.nist.gov/vuln/detail/CVE-2022-24999",
        "sourceLabel": "CVE-2022-24999",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "benchmark_additional_01",
    "name": "Cross-Site Scripting (XSS) - DOM-based XSS via URL parameters",
    "code": "// Additional benchmark: DOM-based XSS\nfunction parseUrlParams() {\n    const params = new URLSearchParams(window.location.search);\n    const message = params.get('message');\n    \n    // Vulnerable: Direct DOM manipulation\n    if (message) {\n        document.getElementById('content').innerHTML = message;\n    }\n}\n\nwindow.onload = parseUrlParams;",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Cross-Site Scripting (XSS)",
        "cwe": "CWE-79",
        "severity": "high",
        "description": "DOM-based XSS via URL parameters"
      }
    ],
    "expectedFix": "Escape/sanitize untrusted content and avoid unsafe DOM sinks.",
    "metadata": {
      "sourceDataset": "benchmark",
      "sourcePolicy": "all",
      "source": "Additional Benchmark Pattern",
      "originalId": "benchmark_additional_01",
      "vulnerableLines": [
        6
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Additional Benchmark Pattern",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Additional Benchmark Pattern",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "benchmark_additional_02",
    "name": "SQL Injection - SQL injection in ORDER BY clause",
    "code": "// Additional benchmark: SQL injection in ORDER BY\nconst mysql = require('mysql');\n\nfunction getUsers(sortBy, sortOrder) {\n    const connection = mysql.createConnection(dbConfig);\n    \n    // Vulnerable: Unvalidated ORDER BY parameters\n    const query = `SELECT * FROM users ORDER BY ${sortBy} ${sortOrder}`;\n    \n    return new Promise((resolve, reject) => {\n        connection.query(query, (error, results) => {\n            if (error) reject(error);\n            else resolve(results);\n        });\n    });\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "SQL Injection",
        "cwe": "CWE-89",
        "severity": "high",
        "description": "SQL injection in ORDER BY clause"
      }
    ],
    "expectedFix": "Use parameterized SQL queries or prepared statements.",
    "metadata": {
      "sourceDataset": "benchmark",
      "sourcePolicy": "all",
      "source": "Additional Benchmark Pattern",
      "originalId": "benchmark_additional_02",
      "vulnerableLines": [
        7
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Additional Benchmark Pattern",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Additional Benchmark Pattern",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "benchmark_additional_03",
    "name": "Command Injection - Command injection via file processing",
    "code": "// Additional benchmark: Command injection\nconst { spawn } = require('child_process');\n\nfunction convertImage(inputFile, outputFormat) {\n    // Vulnerable: Unvalidated file parameters\n    const args = ['-format', outputFormat, inputFile, `output.${outputFormat}`];\n    \n    const convert = spawn('convert', args);\n    \n    convert.on('error', (error) => {\n        console.error('Conversion failed:', error);\n    });\n    \n    return convert;\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Command Injection",
        "cwe": "CWE-78",
        "severity": "high",
        "description": "Command injection via file processing"
      }
    ],
    "expectedFix": "Use safe process APIs and never concatenate untrusted input into commands.",
    "metadata": {
      "sourceDataset": "benchmark",
      "sourcePolicy": "all",
      "source": "Additional Benchmark Pattern",
      "originalId": "benchmark_additional_03",
      "vulnerableLines": [
        6
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Additional Benchmark Pattern",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Additional Benchmark Pattern",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "benchmark_additional_04",
    "name": "Path Traversal - Path traversal in template inclusion",
    "code": "// Additional benchmark: Template path traversal\nconst fs = require('fs');\nconst path = require('path');\n\nfunction includeTemplate(templateName) {\n    // Vulnerable: No path validation\n    const templatePath = path.join('./templates', templateName + '.html');\n    \n    try {\n        return fs.readFileSync(templatePath, 'utf8');\n    } catch (error) {\n        return '<div>Template not found</div>';\n    }\n}\n\nfunction renderPage(template, data) {\n    const templateContent = includeTemplate(template);\n    return templateContent.replace(/{{(\\w+)}}/g, (match, key) => data[key] || '');\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Path Traversal",
        "cwe": "CWE-22",
        "severity": "medium",
        "description": "Path traversal in template inclusion"
      }
    ],
    "expectedFix": "Canonicalize paths and restrict access to approved directories.",
    "metadata": {
      "sourceDataset": "benchmark",
      "sourcePolicy": "all",
      "source": "Additional Benchmark Pattern",
      "originalId": "benchmark_additional_04",
      "vulnerableLines": [
        6
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Additional Benchmark Pattern",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Additional Benchmark Pattern",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "benchmark_additional_05",
    "name": "Insecure Deserialization - Unsafe deserialization in session handling",
    "code": "// Additional benchmark: Unsafe deserialization\nfunction deserializeSession(sessionData) {\n    try {\n        // Vulnerable: eval-based deserialization\n        return eval('(' + sessionData + ')');\n    } catch (error) {\n        return null;\n    }\n}\n\nfunction restoreUserSession(req, res, next) {\n    const sessionCookie = req.cookies.session;\n    \n    if (sessionCookie) {\n        // Vulnerable: Deserializing untrusted data\n        req.user = deserializeSession(decodeURIComponent(sessionCookie));\n    }\n    \n    next();\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Insecure Deserialization",
        "cwe": "CWE-502",
        "severity": "high",
        "description": "Unsafe deserialization in session handling"
      }
    ],
    "expectedFix": "Use safe serializers or strict type/schema validation.",
    "metadata": {
      "sourceDataset": "benchmark",
      "sourcePolicy": "all",
      "source": "Additional Benchmark Pattern",
      "originalId": "benchmark_additional_05",
      "vulnerableLines": [
        4,
        13
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Additional Benchmark Pattern",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Additional Benchmark Pattern",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "benchmark_additional_06",
    "name": "Hardcoded Credentials - Hardcoded database credentials",
    "code": "// Additional benchmark: Hardcoded credentials\nconst mysql = require('mysql');\n\nfunction createDatabaseConnection() {\n    // Vulnerable: Hardcoded credentials\n    const connection = mysql.createConnection({\n        host: 'localhost',\n        user: 'admin',\n        password: 'SuperSecret123!',\n        database: 'production_db'\n    });\n    \n    return connection;\n}\n\nconst dbConfig = {\n    // Vulnerable: Another hardcoded credential\n    apiKey: 'sk-1234567890abcdef',\n    secretKey: 'secret_key_hardcoded_here'\n};",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Hardcoded Credentials",
        "cwe": "CWE-798",
        "severity": "high",
        "description": "Hardcoded database credentials"
      }
    ],
    "expectedFix": "Remove hardcoded secrets and load credentials from secure storage.",
    "metadata": {
      "sourceDataset": "benchmark",
      "sourcePolicy": "all",
      "source": "Additional Benchmark Pattern",
      "originalId": "benchmark_additional_06",
      "vulnerableLines": [
        9,
        17
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Additional Benchmark Pattern",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Additional Benchmark Pattern",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "benchmark_additional_07",
    "name": "Weak Cryptography - Weak cryptographic hash functions",
    "code": "// Additional benchmark: Weak cryptography\nconst crypto = require('crypto');\n\nfunction hashUserPassword(password, salt) {\n    // Vulnerable: Using SHA1 for password hashing\n    return crypto.createHash('sha1').update(password + salt).digest('hex');\n}\n\nfunction generateSessionId() {\n    // Vulnerable: Weak random generation\n    return Math.random().toString(36).substring(2, 15) + \n           Math.random().toString(36).substring(2, 15);\n}\n\nfunction encryptSensitiveData(data, key) {\n    // Vulnerable: Using RC4 cipher\n    const cipher = crypto.createCipher('rc4', key);\n    let encrypted = cipher.update(data, 'utf8', 'hex');\n    encrypted += cipher.final('hex');\n    return encrypted;\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Weak Cryptography",
        "cwe": "CWE-327",
        "severity": "medium",
        "description": "Weak cryptographic hash functions"
      }
    ],
    "expectedFix": "Use strong algorithms and secure key generation/management.",
    "metadata": {
      "sourceDataset": "benchmark",
      "sourcePolicy": "all",
      "source": "Additional Benchmark Pattern",
      "originalId": "benchmark_additional_07",
      "vulnerableLines": [
        5,
        10,
        16
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Additional Benchmark Pattern",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Additional Benchmark Pattern",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "benchmark_additional_08",
    "name": "Improper Authentication - Authentication bypass via parameter manipulation",
    "code": "// Additional benchmark: Authentication bypass\nfunction authenticateUser(username, password, isAdmin) {\n    const users = getUserDatabase();\n    const user = users.find(u => u.username === username);\n    \n    // Vulnerable: Client-controlled admin flag\n    if (isAdmin === 'true') {\n        return { authenticated: true, role: 'admin', user: user };\n    }\n    \n    if (user && user.password === password) {\n        return { authenticated: true, role: user.role, user: user };\n    }\n    \n    return { authenticated: false };\n}\n\nfunction checkAdminAccess(req, res, next) {\n    // Vulnerable: No proper authentication check\n    if (req.query.admin === 'true') {\n        req.user = { role: 'admin' };\n    }\n    next();\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Improper Authentication",
        "cwe": "CWE-287",
        "severity": "high",
        "description": "Authentication bypass via parameter manipulation"
      }
    ],
    "expectedFix": "Enforce robust authentication and fail securely on invalid auth state.",
    "metadata": {
      "sourceDataset": "benchmark",
      "sourcePolicy": "all",
      "source": "Additional Benchmark Pattern",
      "originalId": "benchmark_additional_08",
      "vulnerableLines": [
        6,
        19
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Additional Benchmark Pattern",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Additional Benchmark Pattern",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "benchmark_additional_09",
    "name": "Server-Side Request Forgery (SSRF) - Server-Side Request Forgery in webhook",
    "code": "// Additional benchmark: SSRF vulnerability\nconst axios = require('axios');\n\nasync function processWebhook(webhookUrl, data) {\n    try {\n        // Vulnerable: No URL validation\n        const response = await axios.post(webhookUrl, data);\n        return response.data;\n    } catch (error) {\n        throw new Error('Webhook failed');\n    }\n}\n\nasync function fetchExternalResource(url) {\n    // Vulnerable: Unrestricted URL access\n    const response = await fetch(url);\n    return response.text();\n}\n\nfunction proxyRequest(targetUrl) {\n    // Vulnerable: Open proxy functionality\n    return fetch(targetUrl).then(r => r.text());\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Server-Side Request Forgery (SSRF)",
        "cwe": "CWE-918",
        "severity": "high",
        "description": "Server-Side Request Forgery in webhook"
      }
    ],
    "expectedFix": "Validate outbound targets and restrict requests with allowlists/network controls.",
    "metadata": {
      "sourceDataset": "benchmark",
      "sourcePolicy": "all",
      "source": "Additional Benchmark Pattern",
      "originalId": "benchmark_additional_09",
      "vulnerableLines": [
        6,
        13,
        19
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Additional Benchmark Pattern",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Additional Benchmark Pattern",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "benchmark_additional_10",
    "name": "Prototype Pollution - Prototype pollution via recursive merge",
    "code": "// Additional benchmark: Prototype pollution\nfunction recursiveMerge(target, source) {\n    for (const key in source) {\n        if (source.hasOwnProperty(key)) {\n            if (typeof source[key] === 'object' && source[key] !== null) {\n                if (!target[key]) target[key] = {};\n                // Vulnerable: No __proto__ protection\n                recursiveMerge(target[key], source[key]);\n            } else {\n                target[key] = source[key];\n            }\n        }\n    }\n    return target;\n}\n\nfunction updateConfig(userConfig) {\n    const defaultConfig = { timeout: 5000, retries: 3 };\n    // Vulnerable: Merging untrusted user input\n    return recursiveMerge(defaultConfig, userConfig);\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Prototype Pollution",
        "cwe": "CWE-1321",
        "severity": "high",
        "description": "Prototype pollution via recursive merge"
      }
    ],
    "expectedFix": "Block dangerous keys and clone/validate objects before merge operations.",
    "metadata": {
      "sourceDataset": "benchmark",
      "sourcePolicy": "all",
      "source": "Additional Benchmark Pattern",
      "originalId": "benchmark_additional_10",
      "vulnerableLines": [
        8,
        18
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Additional Benchmark Pattern",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Additional Benchmark Pattern",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "juice_shop_3",
    "name": "Code Injection - Arbitrary file write via ZIP slip",
    "code": "// Arbitrary file write via ZIP slip\n// CWE: CWE-95\n// Severity: critical\n// Source: OWASP Juice Shop\n\n// From OWASP Juice Shop - File upload\nconst unzipper = require('unzipper');\nconst path = require('path');\n\narchive.pipe(unzipper.Extract({ \n  path: uploadDir \n}));",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Code Injection",
        "cwe": "CWE-95",
        "severity": "high",
        "description": "Arbitrary file write via ZIP slip"
      }
    ],
    "expectedFix": "Avoid dynamic code execution and validate or whitelist inputs.",
    "metadata": {
      "sourceDataset": "benchmark",
      "sourcePolicy": "all",
      "source": "OWASP Juice Shop",
      "originalId": "juice_shop_3",
      "vulnerableLines": [],
      "provenance": {
        "sourceType": "owasp-juice-shop",
        "referenceId": "OWASP Juice Shop",
        "sourceUrl": "https://github.com/juice-shop/juice-shop",
        "sourceLabel": "OWASP Juice Shop",
        "sourceProject": null,
        "collectedFrom": "file-source",
        "sourcePath": "benchmark/code-injection/juice_shop_3.js"
      }
    }
  },
  {
    "id": "juliet_cwe95_js_01",
    "name": "Code Injection - Code injection via eval (adapted from Juliet CWE95)",
    "code": "// Code injection via eval (adapted from Juliet CWE95)\n// CWE: CWE-95\n// Severity: critical\n// Source: Juliet Test Suite (adapted)\n// Vulnerable lines: [5]\n\n// Adapted from Juliet Test Suite CWE-95\nfunction processUserCommand(command) {\n    try {\n        // CWE-95: Code injection via eval()\n        const result = eval(\"(\" + command + \")\");\n        return {\n            success: true,\n            result: result\n        };\n    } catch (error) {\n        return {\n            success: false,\n            error: error.message\n        };\n    }\n}\n\n// Example usage that enables code injection\nfunction executeUserScript(scriptContent) {\n    return processUserCommand(scriptContent);\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Code Injection",
        "cwe": "CWE-95",
        "severity": "high",
        "description": "Code injection via eval (adapted from Juliet CWE95)"
      }
    ],
    "expectedFix": "Avoid dynamic code execution and validate or whitelist inputs.",
    "metadata": {
      "sourceDataset": "benchmark",
      "sourcePolicy": "all",
      "source": "Juliet Test Suite (adapted)",
      "originalId": "juliet_cwe95_js_01",
      "vulnerableLines": [
        5
      ],
      "provenance": {
        "sourceType": "nist-juliet",
        "referenceId": "Juliet Test Suite (adapted)",
        "sourceUrl": "https://samate.nist.gov/SARD/",
        "sourceLabel": "Juliet Test Suite (adapted)",
        "sourceProject": null,
        "collectedFrom": "file-source",
        "sourcePath": "benchmark/code-injection/juliet_cwe95_js_01.js"
      }
    }
  },
  {
    "id": "juliet_cwe22_js_01",
    "name": "Path Traversal - Path traversal via file access (adapted from Juliet CWE22)",
    "code": "// Path traversal via file access (adapted from Juliet CWE22)\n// CWE: CWE-22\n// Severity: high\n// Source: Juliet Test Suite (adapted)\n// Vulnerable lines: [8]\n\n// Adapted from Juliet Test Suite CWE-22\nconst fs = require('fs');\nconst path = require('path');\n\nfunction readUserFile(fileName) {\n    const baseDir = '/app/user-files/';\n    \n    // CWE-22: Path traversal via unvalidated file path\n    const filePath = baseDir + fileName;\n    \n    try {\n        const content = fs.readFileSync(filePath, 'utf8');\n        return content;\n    } catch (error) {\n        throw new Error('File not found');\n    }\n}\n\n// Usage that enables path traversal\nfunction getFileContent(userProvidedPath) {\n    return readUserFile(userProvidedPath);\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Path Traversal",
        "cwe": "CWE-22",
        "severity": "high",
        "description": "Path traversal via file access (adapted from Juliet CWE22)"
      }
    ],
    "expectedFix": "Canonicalize paths and restrict access to approved directories.",
    "metadata": {
      "sourceDataset": "benchmark",
      "sourcePolicy": "all",
      "source": "Juliet Test Suite (adapted)",
      "originalId": "juliet_cwe22_js_01",
      "vulnerableLines": [
        8
      ],
      "provenance": {
        "sourceType": "nist-juliet",
        "referenceId": "Juliet Test Suite (adapted)",
        "sourceUrl": "https://samate.nist.gov/SARD/",
        "sourceLabel": "Juliet Test Suite (adapted)",
        "sourceProject": null,
        "collectedFrom": "file-source",
        "sourcePath": "benchmark/path-traversal/juliet_cwe22_js_01.js"
      }
    }
  },
  {
    "id": "nodegoat_session-fixation",
    "name": "Authentication Bypass - Session fixation vulnerability",
    "code": "// Session fixation vulnerability\n// CWE: CWE-384\n// Severity: high\n// Source: OWASP NodeGoat - session.js\n\n            if (err) return next(err);\n        });\n    };\n\n    this.isAdminUserMiddleware = (req, res, next) => {\n        if (req.session.userId) {\n            return userDAO.getUserById(req.session.userId, (err, user) => {\n               return user && user.isAdmin ? next() : res.redirect(\"/login\");\n            });\n        }\n        console.log(\"redirecting to login\");",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Authentication Bypass",
        "cwe": "CWE-384",
        "severity": "high",
        "description": "Session fixation vulnerability"
      }
    ],
    "expectedFix": "Regenerate session IDs after authentication and set secure session flags.",
    "metadata": {
      "sourceDataset": "benchmark",
      "sourcePolicy": "all",
      "source": "OWASP NodeGoat - session.js",
      "originalId": "nodegoat_session-fixation",
      "vulnerableLines": [],
      "provenance": {
        "sourceType": "owasp-nodegoat",
        "referenceId": "OWASP NodeGoat - session.js",
        "sourceUrl": "https://github.com/OWASP/NodeGoat",
        "sourceLabel": "OWASP NodeGoat - session.js",
        "sourceProject": "owasp nodegoat",
        "collectedFrom": "file-source",
        "sourcePath": "benchmark/session-fixation/nodegoat_session-fixation.js"
      }
    }
  },
  {
    "id": "juice_shop_1",
    "name": "SQL Injection - SQL injection in user login",
    "code": "// SQL injection in user login\n// CWE: CWE-89\n// Severity: high\n// Source: OWASP Juice Shop\n\n// From OWASP Juice Shop - Login bypass\nconst user = models.User.findOne({\n  where: {\n    email: req.body.email,\n    password: security.hash(req.body.password)\n  }\n});",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "SQL Injection",
        "cwe": "CWE-89",
        "severity": "high",
        "description": "SQL injection in user login"
      }
    ],
    "expectedFix": "Use parameterized SQL queries or prepared statements.",
    "metadata": {
      "sourceDataset": "benchmark",
      "sourcePolicy": "all",
      "source": "OWASP Juice Shop",
      "originalId": "juice_shop_1",
      "vulnerableLines": [],
      "provenance": {
        "sourceType": "owasp-juice-shop",
        "referenceId": "OWASP Juice Shop",
        "sourceUrl": "https://github.com/juice-shop/juice-shop",
        "sourceLabel": "OWASP Juice Shop",
        "sourceProject": null,
        "collectedFrom": "file-source",
        "sourcePath": "benchmark/sql-injection/juice_shop_1.js"
      }
    }
  },
  {
    "id": "juliet_cwe89_js_01",
    "name": "SQL Injection - SQL injection via string concatenation (adapted from Juliet CWE89)",
    "code": "// SQL injection via string concatenation (adapted from Juliet CWE89)\n// CWE: CWE-89\n// Severity: critical\n// Source: Juliet Test Suite (adapted)\n// Vulnerable lines: [10]\n\n// Adapted from Juliet Test Suite CWE-89\nconst mysql = require('mysql');\n\nfunction getUserData(userId) {\n    const connection = mysql.createConnection({\n        host: 'localhost',\n        user: 'app',\n        database: 'users'\n    });\n    \n    // CWE-89: SQL injection via string concatenation\n    const query = \"SELECT * FROM users WHERE id = \" + userId;\n    \n    return new Promise((resolve, reject) => {\n        connection.query(query, (error, results) => {\n            if (error) reject(error);\n            else resolve(results);\n        });\n    });\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "SQL Injection",
        "cwe": "CWE-89",
        "severity": "high",
        "description": "SQL injection via string concatenation (adapted from Juliet CWE89)"
      }
    ],
    "expectedFix": "Use parameterized SQL queries or prepared statements.",
    "metadata": {
      "sourceDataset": "benchmark",
      "sourcePolicy": "all",
      "source": "Juliet Test Suite (adapted)",
      "originalId": "juliet_cwe89_js_01",
      "vulnerableLines": [
        10
      ],
      "provenance": {
        "sourceType": "nist-juliet",
        "referenceId": "Juliet Test Suite (adapted)",
        "sourceUrl": "https://samate.nist.gov/SARD/",
        "sourceLabel": "Juliet Test Suite (adapted)",
        "sourceProject": null,
        "collectedFrom": "file-source",
        "sourcePath": "benchmark/sql-injection/juliet_cwe89_js_01.js"
      }
    }
  },
  {
    "id": "owasp_bench_sql_01",
    "name": "SQL Injection - SQL injection in search functionality (OWASP Benchmark pattern)",
    "code": "// SQL injection in search functionality (OWASP Benchmark pattern)\n// CWE: CWE-89\n// Severity: critical\n// Source: OWASP Benchmark (adapted)\n// Vulnerable lines: [7]\n\n// OWASP Benchmark pattern adapted to JavaScript\nconst sqlite3 = require('sqlite3').verbose();\n\nfunction searchProducts(searchTerm) {\n    const db = new sqlite3.Database('products.db');\n    \n    // Vulnerable: Direct string concatenation\n    const query = `SELECT * FROM products WHERE name LIKE '%${searchTerm}%'`;\n    \n    return new Promise((resolve, reject) => {\n        db.all(query, [], (err, rows) => {\n            if (err) reject(err);\n            else resolve(rows);\n        });\n    });\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "SQL Injection",
        "cwe": "CWE-89",
        "severity": "high",
        "description": "SQL injection in search functionality (OWASP Benchmark pattern)"
      }
    ],
    "expectedFix": "Use parameterized SQL queries or prepared statements.",
    "metadata": {
      "sourceDataset": "benchmark",
      "sourcePolicy": "all",
      "source": "OWASP Benchmark (adapted)",
      "originalId": "owasp_bench_sql_01",
      "vulnerableLines": [
        7
      ],
      "provenance": {
        "sourceType": "owasp-benchmark",
        "referenceId": "OWASP Benchmark (adapted)",
        "sourceUrl": "https://github.com/OWASP-Benchmark/Benchmark",
        "sourceLabel": "OWASP Benchmark (adapted)",
        "sourceProject": null,
        "collectedFrom": "file-source",
        "sourcePath": "benchmark/sql-injection/owasp_bench_sql_01.js"
      }
    }
  },
  {
    "id": "juice_shop_2",
    "name": "Cross-Site Scripting (XSS) - DOM-based XSS in search",
    "code": "// DOM-based XSS in search\n// CWE: CWE-79\n// Severity: medium\n// Source: OWASP Juice Shop\n\n// From OWASP Juice Shop - Search functionality\nfunction search() {\n  const searchValue = $('#searchQuery').val();\n  $('#searchResult').html('<h3>Results for \"' + searchValue + '\"</h3>');\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Cross-Site Scripting (XSS)",
        "cwe": "CWE-79",
        "severity": "medium",
        "description": "DOM-based XSS in search"
      }
    ],
    "expectedFix": "Escape/sanitize untrusted content and avoid unsafe DOM sinks.",
    "metadata": {
      "sourceDataset": "benchmark",
      "sourcePolicy": "all",
      "source": "OWASP Juice Shop",
      "originalId": "juice_shop_2",
      "vulnerableLines": [],
      "provenance": {
        "sourceType": "owasp-juice-shop",
        "referenceId": "OWASP Juice Shop",
        "sourceUrl": "https://github.com/juice-shop/juice-shop",
        "sourceLabel": "OWASP Juice Shop",
        "sourceProject": null,
        "collectedFrom": "file-source",
        "sourcePath": "benchmark/xss/juice_shop_2.js"
      }
    }
  },
  {
    "id": "juliet_cwe79_js_01",
    "name": "Cross-Site Scripting (XSS) - Cross-site scripting via innerHTML (adapted from Juliet CWE79)",
    "code": "// Cross-site scripting via innerHTML (adapted from Juliet CWE79)\n// CWE: CWE-79\n// Severity: high\n// Source: Juliet Test Suite (adapted)\n// Vulnerable lines: [6]\n\n// Adapted from Juliet Test Suite CWE-79\nfunction displayUserMessage(userInput) {\n    const messageContainer = document.getElementById('messageArea');\n    \n    // CWE-79: XSS via innerHTML without sanitization\n    messageContainer.innerHTML = \"<div class='message'>\" + userInput + \"</div>\";\n    \n    // Show the message\n    messageContainer.style.display = 'block';\n}\n\n// Usage example that enables XSS\nfunction handleFormSubmit() {\n    const userMessage = document.getElementById('userInput').value;\n    displayUserMessage(userMessage);\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Cross-Site Scripting (XSS)",
        "cwe": "CWE-79",
        "severity": "high",
        "description": "Cross-site scripting via innerHTML (adapted from Juliet CWE79)"
      }
    ],
    "expectedFix": "Escape/sanitize untrusted content and avoid unsafe DOM sinks.",
    "metadata": {
      "sourceDataset": "benchmark",
      "sourcePolicy": "all",
      "source": "Juliet Test Suite (adapted)",
      "originalId": "juliet_cwe79_js_01",
      "vulnerableLines": [
        6
      ],
      "provenance": {
        "sourceType": "nist-juliet",
        "referenceId": "Juliet Test Suite (adapted)",
        "sourceUrl": "https://samate.nist.gov/SARD/",
        "sourceLabel": "Juliet Test Suite (adapted)",
        "sourceProject": null,
        "collectedFrom": "file-source",
        "sourcePath": "benchmark/xss/juliet_cwe79_js_01.js"
      }
    }
  },
  {
    "id": "owasp_bench_xss_01",
    "name": "Cross-Site Scripting (XSS) - XSS in dynamic content generation (OWASP Benchmark pattern)",
    "code": "// XSS in dynamic content generation (OWASP Benchmark pattern)\n// CWE: CWE-79\n// Severity: high\n// Source: OWASP Benchmark (adapted)\n// Vulnerable lines: [9]\n\n// OWASP Benchmark pattern adapted to JavaScript\nfunction generateUserProfile(userName, userBio) {\n    const profileHtml = `\n        <div class=\"profile\">\n            <h2>Profile: ${userName}</h2>\n            <div class=\"bio\">${userBio}</div>\n        </div>\n    `;\n    \n    // Vulnerable: Unescaped template literal\n    document.getElementById('profileContainer').innerHTML = profileHtml;\n}\n\nfunction displayProfile(userData) {\n    generateUserProfile(userData.name, userData.bio);\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Cross-Site Scripting (XSS)",
        "cwe": "CWE-79",
        "severity": "high",
        "description": "XSS in dynamic content generation (OWASP Benchmark pattern)"
      }
    ],
    "expectedFix": "Escape/sanitize untrusted content and avoid unsafe DOM sinks.",
    "metadata": {
      "sourceDataset": "benchmark",
      "sourcePolicy": "all",
      "source": "OWASP Benchmark (adapted)",
      "originalId": "owasp_bench_xss_01",
      "vulnerableLines": [
        9
      ],
      "provenance": {
        "sourceType": "owasp-benchmark",
        "referenceId": "OWASP Benchmark (adapted)",
        "sourceUrl": "https://github.com/OWASP-Benchmark/Benchmark",
        "sourceLabel": "OWASP Benchmark (adapted)",
        "sourceProject": null,
        "collectedFrom": "file-source",
        "sourcePath": "benchmark/xss/owasp_bench_xss_01.js"
      }
    }
  },
  {
    "id": "devign_fallback_01",
    "name": "SQL Injection - SQL injection pattern (Devign-style)",
    "code": "// Devign-style vulnerability pattern\nfunction queryUser(userId) {\n    const query = \"SELECT * FROM users WHERE id = \" + userId;\n    return database.execute(query);\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "SQL Injection",
        "cwe": "CWE-89",
        "severity": "high",
        "description": "SQL injection pattern (Devign-style)"
      }
    ],
    "expectedFix": "Use parameterized SQL queries or prepared statements.",
    "metadata": {
      "sourceDataset": "extended",
      "sourcePolicy": "all",
      "source": "Devign Pattern (fallback)",
      "originalId": "devign_fallback_01",
      "vulnerableLines": [
        3
      ],
      "provenance": {
        "sourceType": "devign-dataset",
        "referenceId": "Devign Pattern (fallback)",
        "sourceUrl": "https://github.com/epicosy/devign",
        "sourceLabel": "Devign Pattern (fallback)",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "devign_fallback_02",
    "name": "Command Injection - Command injection vulnerability (Devign-style)",
    "code": "// Devign-style command injection\nconst { exec } = require('child_process');\n\nfunction processFile(filename) {\n    // Vulnerable: Command injection\n    const command = `file ${filename}`;\n    exec(command, (error, stdout, stderr) => {\n        console.log(stdout);\n    });\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Command Injection",
        "cwe": "CWE-78",
        "severity": "high",
        "description": "Command injection vulnerability (Devign-style)"
      }
    ],
    "expectedFix": "Use safe process APIs and never concatenate untrusted input into commands.",
    "metadata": {
      "sourceDataset": "extended",
      "sourcePolicy": "all",
      "source": "Devign Pattern (fallback)",
      "originalId": "devign_fallback_02",
      "vulnerableLines": [
        6
      ],
      "provenance": {
        "sourceType": "devign-dataset",
        "referenceId": "Devign Pattern (fallback)",
        "sourceUrl": "https://github.com/epicosy/devign",
        "sourceLabel": "Devign Pattern (fallback)",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "devign_fallback_03",
    "name": "Cross-Site Scripting (XSS) - XSS vulnerability in DOM manipulation (Devign-style)",
    "code": "// Devign-style XSS vulnerability\nfunction displayMessage(userMessage) {\n    const container = document.getElementById('messageContainer');\n    \n    // Vulnerable: Unescaped HTML insertion\n    container.innerHTML = '<div class=\"message\">' + userMessage + '</div>';\n}\n\nfunction updateProfile(name, bio) {\n    document.getElementById('userName').innerHTML = name;\n    document.getElementById('userBio').innerHTML = bio;\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Cross-Site Scripting (XSS)",
        "cwe": "CWE-79",
        "severity": "high",
        "description": "XSS vulnerability in DOM manipulation (Devign-style)"
      }
    ],
    "expectedFix": "Escape/sanitize untrusted content and avoid unsafe DOM sinks.",
    "metadata": {
      "sourceDataset": "extended",
      "sourcePolicy": "all",
      "source": "Devign Pattern (fallback)",
      "originalId": "devign_fallback_03",
      "vulnerableLines": [
        5,
        9,
        10
      ],
      "provenance": {
        "sourceType": "devign-dataset",
        "referenceId": "Devign Pattern (fallback)",
        "sourceUrl": "https://github.com/epicosy/devign",
        "sourceLabel": "Devign Pattern (fallback)",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "devign_fallback_04",
    "name": "Path Traversal - Path traversal in file operations (Devign-style)",
    "code": "// Devign-style path traversal\nconst fs = require('fs');\n\nfunction readUserFile(userId, filename) {\n    // Vulnerable: No path validation\n    const filepath = './users/' + userId + '/' + filename;\n    \n    try {\n        return fs.readFileSync(filepath, 'utf8');\n    } catch (error) {\n        throw new Error('File not found');\n    }\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Path Traversal",
        "cwe": "CWE-22",
        "severity": "high",
        "description": "Path traversal in file operations (Devign-style)"
      }
    ],
    "expectedFix": "Canonicalize paths and restrict access to approved directories.",
    "metadata": {
      "sourceDataset": "extended",
      "sourcePolicy": "all",
      "source": "Devign Pattern (fallback)",
      "originalId": "devign_fallback_04",
      "vulnerableLines": [
        5
      ],
      "provenance": {
        "sourceType": "devign-dataset",
        "referenceId": "Devign Pattern (fallback)",
        "sourceUrl": "https://github.com/epicosy/devign",
        "sourceLabel": "Devign Pattern (fallback)",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "devign_fallback_05",
    "name": "Insecure Deserialization - Insecure deserialization vulnerability (Devign-style)",
    "code": "// Devign-style insecure deserialization\nfunction processUserData(serializedData) {\n    // Vulnerable: Using eval for deserialization\n    const userData = eval('(' + serializedData + ')');\n    \n    if (userData.isAdmin) {\n        return getAdminData();\n    }\n    \n    return getUserData(userData.id);\n}\n\nfunction deserializeConfig(configString) {\n    // Another vulnerable pattern\n    return eval('config = ' + configString);\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Insecure Deserialization",
        "cwe": "CWE-502",
        "severity": "high",
        "description": "Insecure deserialization vulnerability (Devign-style)"
      }
    ],
    "expectedFix": "Use safe serializers or strict type/schema validation.",
    "metadata": {
      "sourceDataset": "extended",
      "sourcePolicy": "all",
      "source": "Devign Pattern (fallback)",
      "originalId": "devign_fallback_05",
      "vulnerableLines": [
        3,
        12
      ],
      "provenance": {
        "sourceType": "devign-dataset",
        "referenceId": "Devign Pattern (fallback)",
        "sourceUrl": "https://github.com/epicosy/devign",
        "sourceLabel": "Devign Pattern (fallback)",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "devign_fallback_06",
    "name": "Improper Authentication - Weak authentication bypass (Devign-style)",
    "code": "// Devign-style authentication bypass\nfunction authenticateUser(username, password) {\n    const users = getUsers();\n    \n    // Vulnerable: Weak comparison allows bypass\n    if (username == 'admin' && password == 'admin') {\n        return { role: 'admin', authenticated: true };\n    }\n    \n    const user = users.find(u => u.username === username);\n    \n    // Vulnerable: Timing attack possible\n    if (user && user.password === password) {\n        return { role: user.role, authenticated: true };\n    }\n    \n    return { authenticated: false };\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Improper Authentication",
        "cwe": "CWE-287",
        "severity": "high",
        "description": "Weak authentication bypass (Devign-style)"
      }
    ],
    "expectedFix": "Enforce robust authentication and fail securely on invalid auth state.",
    "metadata": {
      "sourceDataset": "extended",
      "sourcePolicy": "all",
      "source": "Devign Pattern (fallback)",
      "originalId": "devign_fallback_06",
      "vulnerableLines": [
        5,
        12
      ],
      "provenance": {
        "sourceType": "devign-dataset",
        "referenceId": "Devign Pattern (fallback)",
        "sourceUrl": "https://github.com/epicosy/devign",
        "sourceLabel": "Devign Pattern (fallback)",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "bigvul_fallback_01",
    "name": "SQL Injection - SQL injection vulnerability (Big-Vul style)",
    "code": "// Big-Vul style vulnerability\nfunction searchRecords(term) {\n    const sql = \"SELECT * FROM records WHERE title LIKE '%\" + term + \"%'\";\n    return db.query(sql);\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "SQL Injection",
        "cwe": "CWE-89",
        "severity": "high",
        "description": "SQL injection vulnerability (Big-Vul style)"
      }
    ],
    "expectedFix": "Use parameterized SQL queries or prepared statements.",
    "metadata": {
      "sourceDataset": "extended",
      "sourcePolicy": "all",
      "source": "Big-Vul Pattern (fallback)",
      "originalId": "bigvul_fallback_01",
      "vulnerableLines": [
        3
      ],
      "provenance": {
        "sourceType": "big-vul-dataset",
        "referenceId": "Big-Vul Pattern (fallback)",
        "sourceUrl": "https://github.com/ZeoVan/MSR_20_Code_vulnerability_CSV_Dataset",
        "sourceLabel": "Big-Vul Pattern (fallback)",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "bigvul_fallback_02",
    "name": "Prototype Pollution - Prototype pollution vulnerability (Big-Vul style)",
    "code": "// Big-Vul style prototype pollution (based on lodash CVE-2020-8203)\nfunction merge(target, source) {\n    for (let key in source) {\n        if (typeof source[key] === 'object' && source[key] !== null) {\n            if (!target[key]) target[key] = {};\n            \n            // Vulnerable: No protection against __proto__\n            merge(target[key], source[key]);\n        } else {\n            target[key] = source[key];\n        }\n    }\n    return target;\n}\n\nfunction setPath(object, path, value) {\n    const keys = path.split('.');\n    let current = object;\n    \n    for (let i = 0; i < keys.length - 1; i++) {\n        const key = keys[i];\n        if (!current[key]) current[key] = {};\n        current = current[key];\n    }\n    \n    // Vulnerable: No validation of key\n    current[keys[keys.length - 1]] = value;\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Prototype Pollution",
        "cwe": "CWE-1321",
        "severity": "high",
        "description": "Prototype pollution vulnerability (Big-Vul style)"
      }
    ],
    "expectedFix": "Block dangerous keys and clone/validate objects before merge operations.",
    "metadata": {
      "sourceDataset": "extended",
      "sourcePolicy": "all",
      "source": "Big-Vul Pattern (CVE-2020-8203)",
      "originalId": "bigvul_fallback_02",
      "vulnerableLines": [
        7,
        22
      ],
      "provenance": {
        "sourceType": "cve",
        "referenceId": "CVE-2020-8203",
        "sourceUrl": "https://nvd.nist.gov/vuln/detail/CVE-2020-8203",
        "sourceLabel": "Big-Vul Pattern (CVE-2020-8203)",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "bigvul_fallback_03",
    "name": "Path Traversal - Express.js path traversal (Big-Vul style)",
    "code": "// Big-Vul style Express.js path traversal\nconst express = require('express');\nconst path = require('path');\nconst fs = require('fs');\n\nconst app = express();\n\napp.get('/static/:file', (req, res) => {\n    const filename = req.params.file;\n    \n    // Vulnerable: No path validation (CVE-2022-24999 style)\n    const filePath = path.join('./static', filename);\n    \n    fs.readFile(filePath, (err, data) => {\n        if (err) {\n            res.status(404).send('File not found');\n        } else {\n            res.send(data);\n        }\n    });\n});",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Path Traversal",
        "cwe": "CWE-22",
        "severity": "high",
        "description": "Express.js path traversal (Big-Vul style)"
      }
    ],
    "expectedFix": "Canonicalize paths and restrict access to approved directories.",
    "metadata": {
      "sourceDataset": "extended",
      "sourcePolicy": "all",
      "source": "Big-Vul Pattern (CVE-2022-24999)",
      "originalId": "bigvul_fallback_03",
      "vulnerableLines": [
        11
      ],
      "provenance": {
        "sourceType": "cve",
        "referenceId": "CVE-2022-24999",
        "sourceUrl": "https://nvd.nist.gov/vuln/detail/CVE-2022-24999",
        "sourceLabel": "Big-Vul Pattern (CVE-2022-24999)",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "bigvul_fallback_04",
    "name": "Weak Cryptography - Weak cryptographic implementation (Big-Vul style)",
    "code": "// Big-Vul style weak cryptography (node-forge related)\nconst crypto = require('crypto');\n\nfunction generateApiKey() {\n    // Vulnerable: Weak random number generation\n    const randomBytes = Math.random().toString(36).substring(2, 15);\n    return Buffer.from(randomBytes).toString('base64');\n}\n\nfunction hashPassword(password, salt) {\n    // Vulnerable: Using weak hashing algorithm\n    return crypto.createHash('md5').update(password + salt).digest('hex');\n}\n\nfunction encryptData(data, key) {\n    // Vulnerable: Using deprecated cipher\n    const cipher = crypto.createCipher('des', key);\n    let encrypted = cipher.update(data, 'utf8', 'hex');\n    encrypted += cipher.final('hex');\n    return encrypted;\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Weak Cryptography",
        "cwe": "CWE-327",
        "severity": "medium",
        "description": "Weak cryptographic implementation (Big-Vul style)"
      }
    ],
    "expectedFix": "Use strong algorithms and secure key generation/management.",
    "metadata": {
      "sourceDataset": "extended",
      "sourcePolicy": "all",
      "source": "Big-Vul Pattern (CVE-2022-24771)",
      "originalId": "bigvul_fallback_04",
      "vulnerableLines": [
        5,
        11,
        16
      ],
      "provenance": {
        "sourceType": "cve",
        "referenceId": "CVE-2022-24771",
        "sourceUrl": "https://nvd.nist.gov/vuln/detail/CVE-2022-24771",
        "sourceLabel": "Big-Vul Pattern (CVE-2022-24771)",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "bigvul_fallback_05",
    "name": "Cross-Site Scripting (XSS) - React DOM XSS vulnerability (Big-Vul style)",
    "code": "// Big-Vul style React XSS vulnerability\nimport React from 'react';\n\nfunction UserProfile({ userData }) {\n    // Vulnerable: dangerouslySetInnerHTML without sanitization\n    return (\n        <div className=\"profile\">\n            <h1>Welcome, {userData.name}</h1>\n            <div \n                className=\"bio\"\n                dangerouslySetInnerHTML={{__html: userData.bio}}\n            />\n        </div>\n    );\n}\n\nfunction CommentComponent({ comment }) {\n    // Vulnerable: Direct HTML insertion\n    const commentHtml = comment.text.replace(/\\n/g, '<br>');\n    \n    return <div dangerouslySetInnerHTML={{__html: commentHtml}} />;\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Cross-Site Scripting (XSS)",
        "cwe": "CWE-79",
        "severity": "high",
        "description": "React DOM XSS vulnerability (Big-Vul style)"
      }
    ],
    "expectedFix": "Escape/sanitize untrusted content and avoid unsafe DOM sinks.",
    "metadata": {
      "sourceDataset": "extended",
      "sourcePolicy": "all",
      "source": "Big-Vul Pattern (CVE-2018-6341)",
      "originalId": "bigvul_fallback_05",
      "vulnerableLines": [
        10,
        20
      ],
      "provenance": {
        "sourceType": "cve",
        "referenceId": "CVE-2018-6341",
        "sourceUrl": "https://nvd.nist.gov/vuln/detail/CVE-2018-6341",
        "sourceLabel": "Big-Vul Pattern (CVE-2018-6341)",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "bigvul_fallback_06",
    "name": "Prototype Pollution - Lodash template prototype pollution (Big-Vul style)",
    "code": "// Big-Vul style lodash template vulnerability\nfunction template(templateString, data) {\n    // Vulnerable: Template injection via prototype pollution\n    let result = templateString;\n    \n    for (let key in data) {\n        // Vulnerable: No validation of key names\n        const regex = new RegExp('\\\\{\\\\{\\\\s*' + key + '\\\\s*\\\\}\\\\}', 'g');\n        result = result.replace(regex, data[key]);\n    }\n    \n    return result;\n}\n\nfunction processTemplate(userInput, templateData) {\n    // Vulnerable: User input affects template processing\n    const merged = Object.assign({}, templateData, JSON.parse(userInput));\n    \n    return template('Hello {{name}}, your role is {{role}}', merged);\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Prototype Pollution",
        "cwe": "CWE-1321",
        "severity": "high",
        "description": "Lodash template prototype pollution (Big-Vul style)"
      }
    ],
    "expectedFix": "Block dangerous keys and clone/validate objects before merge operations.",
    "metadata": {
      "sourceDataset": "extended",
      "sourcePolicy": "all",
      "source": "Big-Vul Pattern (CVE-2021-23337)",
      "originalId": "bigvul_fallback_06",
      "vulnerableLines": [
        7,
        15
      ],
      "provenance": {
        "sourceType": "cve",
        "referenceId": "CVE-2021-23337",
        "sourceUrl": "https://nvd.nist.gov/vuln/detail/CVE-2021-23337",
        "sourceLabel": "Big-Vul Pattern (CVE-2021-23337)",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "devign_fallback_01-extended-1",
    "name": "SQL Injection - SQL injection pattern (Devign-style)",
    "code": "// Devign-style vulnerability pattern\nfunction queryUser(userId) {\n    const query = \"SELECT * FROM users WHERE id = \" + userId;\n    return database.execute(query);\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "SQL Injection",
        "cwe": "CWE-89",
        "severity": "high",
        "description": "SQL injection pattern (Devign-style)"
      }
    ],
    "expectedFix": "Use parameterized SQL queries or prepared statements.",
    "metadata": {
      "sourceDataset": "extended",
      "sourcePolicy": "all",
      "source": "Devign Pattern (fallback)",
      "originalId": "devign_fallback_01",
      "vulnerableLines": [
        3
      ],
      "provenance": {
        "sourceType": "devign-dataset",
        "referenceId": "Devign Pattern (fallback)",
        "sourceUrl": "https://github.com/epicosy/devign",
        "sourceLabel": "Devign Pattern (fallback)",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "devign_fallback_02-extended-1",
    "name": "Command Injection - Command injection vulnerability (Devign-style)",
    "code": "// Devign-style command injection\nconst { exec } = require('child_process');\n\nfunction processFile(filename) {\n    // Vulnerable: Command injection\n    const command = `file ${filename}`;\n    exec(command, (error, stdout, stderr) => {\n        console.log(stdout);\n    });\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Command Injection",
        "cwe": "CWE-78",
        "severity": "high",
        "description": "Command injection vulnerability (Devign-style)"
      }
    ],
    "expectedFix": "Use safe process APIs and never concatenate untrusted input into commands.",
    "metadata": {
      "sourceDataset": "extended",
      "sourcePolicy": "all",
      "source": "Devign Pattern (fallback)",
      "originalId": "devign_fallback_02",
      "vulnerableLines": [
        6
      ],
      "provenance": {
        "sourceType": "devign-dataset",
        "referenceId": "Devign Pattern (fallback)",
        "sourceUrl": "https://github.com/epicosy/devign",
        "sourceLabel": "Devign Pattern (fallback)",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "devign_fallback_03-extended-1",
    "name": "Cross-Site Scripting (XSS) - XSS vulnerability in DOM manipulation (Devign-style)",
    "code": "// Devign-style XSS vulnerability\nfunction displayMessage(userMessage) {\n    const container = document.getElementById('messageContainer');\n    \n    // Vulnerable: Unescaped HTML insertion\n    container.innerHTML = '<div class=\"message\">' + userMessage + '</div>';\n}\n\nfunction updateProfile(name, bio) {\n    document.getElementById('userName').innerHTML = name;\n    document.getElementById('userBio').innerHTML = bio;\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Cross-Site Scripting (XSS)",
        "cwe": "CWE-79",
        "severity": "high",
        "description": "XSS vulnerability in DOM manipulation (Devign-style)"
      }
    ],
    "expectedFix": "Escape/sanitize untrusted content and avoid unsafe DOM sinks.",
    "metadata": {
      "sourceDataset": "extended",
      "sourcePolicy": "all",
      "source": "Devign Pattern (fallback)",
      "originalId": "devign_fallback_03",
      "vulnerableLines": [
        5,
        9,
        10
      ],
      "provenance": {
        "sourceType": "devign-dataset",
        "referenceId": "Devign Pattern (fallback)",
        "sourceUrl": "https://github.com/epicosy/devign",
        "sourceLabel": "Devign Pattern (fallback)",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "devign_fallback_04-extended-1",
    "name": "Path Traversal - Path traversal in file operations (Devign-style)",
    "code": "// Devign-style path traversal\nconst fs = require('fs');\n\nfunction readUserFile(userId, filename) {\n    // Vulnerable: No path validation\n    const filepath = './users/' + userId + '/' + filename;\n    \n    try {\n        return fs.readFileSync(filepath, 'utf8');\n    } catch (error) {\n        throw new Error('File not found');\n    }\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Path Traversal",
        "cwe": "CWE-22",
        "severity": "high",
        "description": "Path traversal in file operations (Devign-style)"
      }
    ],
    "expectedFix": "Canonicalize paths and restrict access to approved directories.",
    "metadata": {
      "sourceDataset": "extended",
      "sourcePolicy": "all",
      "source": "Devign Pattern (fallback)",
      "originalId": "devign_fallback_04",
      "vulnerableLines": [
        5
      ],
      "provenance": {
        "sourceType": "devign-dataset",
        "referenceId": "Devign Pattern (fallback)",
        "sourceUrl": "https://github.com/epicosy/devign",
        "sourceLabel": "Devign Pattern (fallback)",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "devign_fallback_05-extended-1",
    "name": "Insecure Deserialization - Insecure deserialization vulnerability (Devign-style)",
    "code": "// Devign-style insecure deserialization\nfunction processUserData(serializedData) {\n    // Vulnerable: Using eval for deserialization\n    const userData = eval('(' + serializedData + ')');\n    \n    if (userData.isAdmin) {\n        return getAdminData();\n    }\n    \n    return getUserData(userData.id);\n}\n\nfunction deserializeConfig(configString) {\n    // Another vulnerable pattern\n    return eval('config = ' + configString);\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Insecure Deserialization",
        "cwe": "CWE-502",
        "severity": "high",
        "description": "Insecure deserialization vulnerability (Devign-style)"
      }
    ],
    "expectedFix": "Use safe serializers or strict type/schema validation.",
    "metadata": {
      "sourceDataset": "extended",
      "sourcePolicy": "all",
      "source": "Devign Pattern (fallback)",
      "originalId": "devign_fallback_05",
      "vulnerableLines": [
        3,
        12
      ],
      "provenance": {
        "sourceType": "devign-dataset",
        "referenceId": "Devign Pattern (fallback)",
        "sourceUrl": "https://github.com/epicosy/devign",
        "sourceLabel": "Devign Pattern (fallback)",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "devign_fallback_06-extended-1",
    "name": "Improper Authentication - Weak authentication bypass (Devign-style)",
    "code": "// Devign-style authentication bypass\nfunction authenticateUser(username, password) {\n    const users = getUsers();\n    \n    // Vulnerable: Weak comparison allows bypass\n    if (username == 'admin' && password == 'admin') {\n        return { role: 'admin', authenticated: true };\n    }\n    \n    const user = users.find(u => u.username === username);\n    \n    // Vulnerable: Timing attack possible\n    if (user && user.password === password) {\n        return { role: user.role, authenticated: true };\n    }\n    \n    return { authenticated: false };\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Improper Authentication",
        "cwe": "CWE-287",
        "severity": "high",
        "description": "Weak authentication bypass (Devign-style)"
      }
    ],
    "expectedFix": "Enforce robust authentication and fail securely on invalid auth state.",
    "metadata": {
      "sourceDataset": "extended",
      "sourcePolicy": "all",
      "source": "Devign Pattern (fallback)",
      "originalId": "devign_fallback_06",
      "vulnerableLines": [
        5,
        12
      ],
      "provenance": {
        "sourceType": "devign-dataset",
        "referenceId": "Devign Pattern (fallback)",
        "sourceUrl": "https://github.com/epicosy/devign",
        "sourceLabel": "Devign Pattern (fallback)",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "bigvul_fallback_01-extended-1",
    "name": "SQL Injection - SQL injection vulnerability (Big-Vul style)",
    "code": "// Big-Vul style vulnerability\nfunction searchRecords(term) {\n    const sql = \"SELECT * FROM records WHERE title LIKE '%\" + term + \"%'\";\n    return db.query(sql);\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "SQL Injection",
        "cwe": "CWE-89",
        "severity": "high",
        "description": "SQL injection vulnerability (Big-Vul style)"
      }
    ],
    "expectedFix": "Use parameterized SQL queries or prepared statements.",
    "metadata": {
      "sourceDataset": "extended",
      "sourcePolicy": "all",
      "source": "Big-Vul Pattern (fallback)",
      "originalId": "bigvul_fallback_01",
      "vulnerableLines": [
        3
      ],
      "provenance": {
        "sourceType": "big-vul-dataset",
        "referenceId": "Big-Vul Pattern (fallback)",
        "sourceUrl": "https://github.com/ZeoVan/MSR_20_Code_vulnerability_CSV_Dataset",
        "sourceLabel": "Big-Vul Pattern (fallback)",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "bigvul_fallback_02-extended-1",
    "name": "Prototype Pollution - Prototype pollution vulnerability (Big-Vul style)",
    "code": "// Big-Vul style prototype pollution (based on lodash CVE-2020-8203)\nfunction merge(target, source) {\n    for (let key in source) {\n        if (typeof source[key] === 'object' && source[key] !== null) {\n            if (!target[key]) target[key] = {};\n            \n            // Vulnerable: No protection against __proto__\n            merge(target[key], source[key]);\n        } else {\n            target[key] = source[key];\n        }\n    }\n    return target;\n}\n\nfunction setPath(object, path, value) {\n    const keys = path.split('.');\n    let current = object;\n    \n    for (let i = 0; i < keys.length - 1; i++) {\n        const key = keys[i];\n        if (!current[key]) current[key] = {};\n        current = current[key];\n    }\n    \n    // Vulnerable: No validation of key\n    current[keys[keys.length - 1]] = value;\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Prototype Pollution",
        "cwe": "CWE-1321",
        "severity": "high",
        "description": "Prototype pollution vulnerability (Big-Vul style)"
      }
    ],
    "expectedFix": "Block dangerous keys and clone/validate objects before merge operations.",
    "metadata": {
      "sourceDataset": "extended",
      "sourcePolicy": "all",
      "source": "Big-Vul Pattern (CVE-2020-8203)",
      "originalId": "bigvul_fallback_02",
      "vulnerableLines": [
        7,
        22
      ],
      "provenance": {
        "sourceType": "cve",
        "referenceId": "CVE-2020-8203",
        "sourceUrl": "https://nvd.nist.gov/vuln/detail/CVE-2020-8203",
        "sourceLabel": "Big-Vul Pattern (CVE-2020-8203)",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "bigvul_fallback_03-extended-1",
    "name": "Path Traversal - Express.js path traversal (Big-Vul style)",
    "code": "// Big-Vul style Express.js path traversal\nconst express = require('express');\nconst path = require('path');\nconst fs = require('fs');\n\nconst app = express();\n\napp.get('/static/:file', (req, res) => {\n    const filename = req.params.file;\n    \n    // Vulnerable: No path validation (CVE-2022-24999 style)\n    const filePath = path.join('./static', filename);\n    \n    fs.readFile(filePath, (err, data) => {\n        if (err) {\n            res.status(404).send('File not found');\n        } else {\n            res.send(data);\n        }\n    });\n});",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Path Traversal",
        "cwe": "CWE-22",
        "severity": "high",
        "description": "Express.js path traversal (Big-Vul style)"
      }
    ],
    "expectedFix": "Canonicalize paths and restrict access to approved directories.",
    "metadata": {
      "sourceDataset": "extended",
      "sourcePolicy": "all",
      "source": "Big-Vul Pattern (CVE-2022-24999)",
      "originalId": "bigvul_fallback_03",
      "vulnerableLines": [
        11
      ],
      "provenance": {
        "sourceType": "cve",
        "referenceId": "CVE-2022-24999",
        "sourceUrl": "https://nvd.nist.gov/vuln/detail/CVE-2022-24999",
        "sourceLabel": "Big-Vul Pattern (CVE-2022-24999)",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "bigvul_fallback_04-extended-1",
    "name": "Weak Cryptography - Weak cryptographic implementation (Big-Vul style)",
    "code": "// Big-Vul style weak cryptography (node-forge related)\nconst crypto = require('crypto');\n\nfunction generateApiKey() {\n    // Vulnerable: Weak random number generation\n    const randomBytes = Math.random().toString(36).substring(2, 15);\n    return Buffer.from(randomBytes).toString('base64');\n}\n\nfunction hashPassword(password, salt) {\n    // Vulnerable: Using weak hashing algorithm\n    return crypto.createHash('md5').update(password + salt).digest('hex');\n}\n\nfunction encryptData(data, key) {\n    // Vulnerable: Using deprecated cipher\n    const cipher = crypto.createCipher('des', key);\n    let encrypted = cipher.update(data, 'utf8', 'hex');\n    encrypted += cipher.final('hex');\n    return encrypted;\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Weak Cryptography",
        "cwe": "CWE-327",
        "severity": "medium",
        "description": "Weak cryptographic implementation (Big-Vul style)"
      }
    ],
    "expectedFix": "Use strong algorithms and secure key generation/management.",
    "metadata": {
      "sourceDataset": "extended",
      "sourcePolicy": "all",
      "source": "Big-Vul Pattern (CVE-2022-24771)",
      "originalId": "bigvul_fallback_04",
      "vulnerableLines": [
        5,
        11,
        16
      ],
      "provenance": {
        "sourceType": "cve",
        "referenceId": "CVE-2022-24771",
        "sourceUrl": "https://nvd.nist.gov/vuln/detail/CVE-2022-24771",
        "sourceLabel": "Big-Vul Pattern (CVE-2022-24771)",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "bigvul_fallback_05-extended-1",
    "name": "Cross-Site Scripting (XSS) - React DOM XSS vulnerability (Big-Vul style)",
    "code": "// Big-Vul style React XSS vulnerability\nimport React from 'react';\n\nfunction UserProfile({ userData }) {\n    // Vulnerable: dangerouslySetInnerHTML without sanitization\n    return (\n        <div className=\"profile\">\n            <h1>Welcome, {userData.name}</h1>\n            <div \n                className=\"bio\"\n                dangerouslySetInnerHTML={{__html: userData.bio}}\n            />\n        </div>\n    );\n}\n\nfunction CommentComponent({ comment }) {\n    // Vulnerable: Direct HTML insertion\n    const commentHtml = comment.text.replace(/\\n/g, '<br>');\n    \n    return <div dangerouslySetInnerHTML={{__html: commentHtml}} />;\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Cross-Site Scripting (XSS)",
        "cwe": "CWE-79",
        "severity": "high",
        "description": "React DOM XSS vulnerability (Big-Vul style)"
      }
    ],
    "expectedFix": "Escape/sanitize untrusted content and avoid unsafe DOM sinks.",
    "metadata": {
      "sourceDataset": "extended",
      "sourcePolicy": "all",
      "source": "Big-Vul Pattern (CVE-2018-6341)",
      "originalId": "bigvul_fallback_05",
      "vulnerableLines": [
        10,
        20
      ],
      "provenance": {
        "sourceType": "cve",
        "referenceId": "CVE-2018-6341",
        "sourceUrl": "https://nvd.nist.gov/vuln/detail/CVE-2018-6341",
        "sourceLabel": "Big-Vul Pattern (CVE-2018-6341)",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "bigvul_fallback_06-extended-1",
    "name": "Prototype Pollution - Lodash template prototype pollution (Big-Vul style)",
    "code": "// Big-Vul style lodash template vulnerability\nfunction template(templateString, data) {\n    // Vulnerable: Template injection via prototype pollution\n    let result = templateString;\n    \n    for (let key in data) {\n        // Vulnerable: No validation of key names\n        const regex = new RegExp('\\\\{\\\\{\\\\s*' + key + '\\\\s*\\\\}\\\\}', 'g');\n        result = result.replace(regex, data[key]);\n    }\n    \n    return result;\n}\n\nfunction processTemplate(userInput, templateData) {\n    // Vulnerable: User input affects template processing\n    const merged = Object.assign({}, templateData, JSON.parse(userInput));\n    \n    return template('Hello {{name}}, your role is {{role}}', merged);\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Prototype Pollution",
        "cwe": "CWE-1321",
        "severity": "high",
        "description": "Lodash template prototype pollution (Big-Vul style)"
      }
    ],
    "expectedFix": "Block dangerous keys and clone/validate objects before merge operations.",
    "metadata": {
      "sourceDataset": "extended",
      "sourcePolicy": "all",
      "source": "Big-Vul Pattern (CVE-2021-23337)",
      "originalId": "bigvul_fallback_06",
      "vulnerableLines": [
        7,
        15
      ],
      "provenance": {
        "sourceType": "cve",
        "referenceId": "CVE-2021-23337",
        "sourceUrl": "https://nvd.nist.gov/vuln/detail/CVE-2021-23337",
        "sourceLabel": "Big-Vul Pattern (CVE-2021-23337)",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "extended_memory_leak_01",
    "name": "Memory Leak - Memory leak via event listener accumulation",
    "code": "// Extended: Memory leak pattern\nclass EventManager {\n    constructor() {\n        this.listeners = [];\n    }\n    \n    addDynamicListener(element, event, callback) {\n        // Vulnerable: Listeners accumulate without cleanup\n        element.addEventListener(event, callback);\n        this.listeners.push({ element, event, callback });\n    }\n    \n    updateContent(data) {\n        data.forEach(item => {\n            const element = document.createElement('div');\n            // Vulnerable: New listeners on each update\n            this.addDynamicListener(element, 'click', () => {\n                console.log(item);\n            });\n            document.body.appendChild(element);\n        });\n    }\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Memory Leak",
        "cwe": "CWE-401",
        "severity": "medium",
        "description": "Memory leak via event listener accumulation"
      }
    ],
    "expectedFix": "Release resources deterministically and avoid unbounded allocations.",
    "metadata": {
      "sourceDataset": "extended",
      "sourcePolicy": "all",
      "source": "Extended Research Pattern",
      "originalId": "extended_memory_leak_01",
      "vulnerableLines": [
        9,
        16
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Extended Research Pattern",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Extended Research Pattern",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "extended_async_race_01",
    "name": "Race Condition - Async race condition in data processing",
    "code": "// Extended: Async race condition\nclass DataProcessor {\n    constructor() {\n        this.processing = false;\n        this.queue = [];\n    }\n    \n    async processData(data) {\n        // Vulnerable: Race condition in async processing\n        if (this.processing) {\n            this.queue.push(data);\n            return;\n        }\n        \n        this.processing = true;\n        \n        try {\n            await this.heavyProcessing(data);\n            \n            // Vulnerable: Queue processing without proper synchronization\n            while (this.queue.length > 0) {\n                const nextData = this.queue.shift();\n                await this.heavyProcessing(nextData);\n            }\n        } finally {\n            this.processing = false;\n        }\n    }\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Race Condition",
        "cwe": "CWE-362",
        "severity": "medium",
        "description": "Async race condition in data processing"
      }
    ],
    "expectedFix": "Use synchronization/atomic operations to protect shared state.",
    "metadata": {
      "sourceDataset": "extended",
      "sourcePolicy": "all",
      "source": "Extended Research Pattern",
      "originalId": "extended_async_race_01",
      "vulnerableLines": [
        9,
        19
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Extended Research Pattern",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Extended Research Pattern",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "extended_input_validation_01",
    "name": "Input Validation - Insufficient input validation in API",
    "code": "// Extended: Input validation bypass\nconst express = require('express');\nconst app = express();\n\napp.post('/api/users', (req, res) => {\n    const { name, email, age, role } = req.body;\n    \n    // Vulnerable: Insufficient validation\n    if (!name || !email) {\n        return res.status(400).json({ error: 'Name and email required' });\n    }\n    \n    // Vulnerable: No validation on role escalation\n    const user = {\n        name: name,\n        email: email,\n        age: parseInt(age) || 0,\n        role: role || 'user', // Can be manipulated to 'admin'\n        created: new Date()\n    };\n    \n    saveUser(user);\n    res.json({ success: true, user: user });\n});",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Input Validation",
        "cwe": "CWE-20",
        "severity": "medium",
        "description": "Insufficient input validation in API"
      }
    ],
    "expectedFix": "Validate and sanitize all untrusted input before use.",
    "metadata": {
      "sourceDataset": "extended",
      "sourcePolicy": "all",
      "source": "Extended Research Pattern",
      "originalId": "extended_input_validation_01",
      "vulnerableLines": [
        15
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Extended Research Pattern",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Extended Research Pattern",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "extended_crypto_weak_key_01",
    "name": "Weak Encryption - Weak encryption key generation",
    "code": "// Extended: Weak key generation\nconst crypto = require('crypto');\n\nfunction generateEncryptionKey(userSeed) {\n    // Vulnerable: Predictable key generation\n    const seed = userSeed || 'default_seed';\n    return crypto.createHash('md5').update(seed).digest('hex').substring(0, 16);\n}\n\nfunction encryptUserData(data, userPassword) {\n    // Vulnerable: Weak key derivation\n    const key = generateEncryptionKey(userPassword);\n    const cipher = crypto.createCipher('aes-128-ecb', key);\n    \n    let encrypted = cipher.update(data, 'utf8', 'hex');\n    encrypted += cipher.final('hex');\n    \n    return encrypted;\n}\n\nclass SecureStorage {\n    constructor() {\n        // Vulnerable: Fixed weak key\n        this.encryptionKey = 'weakKey123';\n    }\n    \n    store(data) {\n        return encryptUserData(JSON.stringify(data), this.encryptionKey);\n    }\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Weak Encryption",
        "cwe": "CWE-326",
        "severity": "high",
        "description": "Weak encryption key generation"
      }
    ],
    "expectedFix": "Use modern encryption modes with secure keys and nonces.",
    "metadata": {
      "sourceDataset": "extended",
      "sourcePolicy": "all",
      "source": "Extended Research Pattern",
      "originalId": "extended_crypto_weak_key_01",
      "vulnerableLines": [
        6,
        11,
        22
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Extended Research Pattern",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Extended Research Pattern",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "extended_information_exposure_01",
    "name": "Information Exposure - Sensitive information exposure in error messages",
    "code": "// Extended: Information exposure\nconst mysql = require('mysql');\n\nfunction authenticateUser(username, password) {\n    const connection = mysql.createConnection(dbConfig);\n    \n    return new Promise((resolve, reject) => {\n        const query = 'SELECT * FROM users WHERE username = ? AND password = ?';\n        \n        connection.query(query, [username, password], (error, results) => {\n            if (error) {\n                // Vulnerable: Exposing database errors\n                reject({\n                    error: 'Authentication failed',\n                    details: error.message,\n                    query: query,\n                    sqlState: error.sqlState\n                });\n                return;\n            }\n            \n            if (results.length === 0) {\n                // Vulnerable: Exposing user enumeration info\n                reject({\n                    error: username.includes('@') ? \n                           'Invalid email address' : \n                           'Username does not exist',\n                    timestamp: new Date(),\n                    attemptedUsername: username\n                });\n                return;\n            }\n            \n            resolve(results[0]);\n        });\n    });\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Information Exposure",
        "cwe": "CWE-200",
        "severity": "medium",
        "description": "Sensitive information exposure in error messages"
      }
    ],
    "expectedFix": "Avoid leaking sensitive data and apply redaction/minimization controls.",
    "metadata": {
      "sourceDataset": "extended",
      "sourcePolicy": "all",
      "source": "Extended Research Pattern",
      "originalId": "extended_information_exposure_01",
      "vulnerableLines": [
        13,
        22
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Extended Research Pattern",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Extended Research Pattern",
        "sourceProject": null,
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "real_world_express_cve_2022_24999",
    "name": "Path Traversal - Real CVE-2022-24999 vulnerability in express",
    "code": "// Real CVE-2022-24999 in Express.js\nconst path = require('path');\nconst fs = require('fs');\n\n// Vulnerable implementation from Express\nfunction sendFile(req, res, options) {\n    const filePath = req.params.path;\n    const root = options.root || './public';\n    \n    // VULNERABILITY: Insufficient path traversal protection\n    const fullPath = path.resolve(root, filePath);\n    \n    if (fs.existsSync(fullPath)) {\n        res.sendFile(fullPath);\n    } else {\n        res.status(404).send('File not found');\n    }\n}\n\n// Attack: GET /files/../../../../etc/passwd",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Path Traversal",
        "cwe": "CWE-22",
        "severity": "high",
        "description": "Real CVE-2022-24999 vulnerability in express"
      }
    ],
    "expectedFix": "Canonicalize paths and restrict access to approved directories.",
    "metadata": {
      "sourceDataset": "real-world",
      "sourcePolicy": "all",
      "source": "express - CVE-2022-24999",
      "originalId": "real_world_express_cve_2022_24999",
      "vulnerableLines": [
        8,
        9
      ],
      "provenance": {
        "sourceType": "cve",
        "referenceId": "CVE-2022-24999",
        "sourceUrl": "https://nvd.nist.gov/vuln/detail/CVE-2022-24999",
        "sourceLabel": "express - CVE-2022-24999",
        "sourceProject": "express",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "real_world_lodash_cve_2021_23337",
    "name": "Prototype Pollution - Real CVE-2021-23337 vulnerability in lodash",
    "code": "// Real CVE-2021-23337 in Lodash\nfunction merge(object, sources) {\n    // Simplified version of vulnerable lodash merge\n    sources.forEach(source => {\n        for (let key in source) {\n            if (source.hasOwnProperty(key)) {\n                // VULNERABILITY: No protection against __proto__ pollution\n                if (typeof source[key] === 'object' && typeof object[key] === 'object') {\n                    merge(object[key], [source[key]]);\n                } else {\n                    object[key] = source[key];\n                }\n            }\n        }\n    });\n    return object;\n}\n\n// Attack payload: {\"__proto__\": {\"polluted\": true}}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Prototype Pollution",
        "cwe": "CWE-1321",
        "severity": "high",
        "description": "Real CVE-2021-23337 vulnerability in lodash"
      }
    ],
    "expectedFix": "Block dangerous keys and clone/validate objects before merge operations.",
    "metadata": {
      "sourceDataset": "real-world",
      "sourcePolicy": "all",
      "source": "lodash - CVE-2021-23337",
      "originalId": "real_world_lodash_cve_2021_23337",
      "vulnerableLines": [
        8,
        9
      ],
      "provenance": {
        "sourceType": "cve",
        "referenceId": "CVE-2021-23337",
        "sourceUrl": "https://nvd.nist.gov/vuln/detail/CVE-2021-23337",
        "sourceLabel": "lodash - CVE-2021-23337",
        "sourceProject": "lodash",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "real_world_lodash_pattern_1",
    "name": "Input Validation - Vulnerability pattern found in lodash",
    "code": "// Extracted from real project file\n// Line 1478: \n// Line 1479:     /** Used to detect methods masquerading as native. */\n// Line 1480:     var maskSrcKey = (function() {\n// Line 1481:       var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n// Line 1482:       return uid ? ('Symbol(src)_1.' + uid) : '';\n// Line 1483:     }());\n// Line 1484: \n// Line 1485:     /**\n// Line 1486:      * Used to resolve the\n// Line 1487:      * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Input Validation",
        "cwe": "CWE-20",
        "severity": "medium",
        "description": "Vulnerability pattern found in lodash"
      }
    ],
    "expectedFix": "Validate and sanitize all untrusted input before use.",
    "metadata": {
      "sourceDataset": "real-world",
      "sourcePolicy": "all",
      "source": "lodash - Pattern Analysis",
      "originalId": "real_world_lodash_pattern_1",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "project-pattern-analysis",
        "referenceId": "lodash - Pattern Analysis",
        "sourceUrl": "https://github.com/lodash/lodash",
        "sourceLabel": "lodash - Pattern Analysis",
        "sourceProject": "lodash",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "real_world_lodash_pattern_3",
    "name": "Input Validation - Vulnerability pattern found in lodash",
    "code": "// Extracted from real project file\n// Line 242:   });\n// Line 243: \n// Line 244:   /** The basename of the lodash file to test. */\n// Line 245:   var basename = /[\\w.-]+$/.exec(filePath)[0];\n// Line 246: \n// Line 247:   /** Used to indicate testing a modularized build. */\n// Line 248:   var isModularize = ui.isModularize;\n// Line 249: \n// Line 250:   /** Detect if testing `npm` modules. */\n// Line 251:   var isNpm = isModularize && /\\bnpm\\b/.test([ui.buildPath, ui.urlParams.build]);",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Input Validation",
        "cwe": "CWE-20",
        "severity": "medium",
        "description": "Vulnerability pattern found in lodash"
      }
    ],
    "expectedFix": "Validate and sanitize all untrusted input before use.",
    "metadata": {
      "sourceDataset": "real-world",
      "sourcePolicy": "all",
      "source": "lodash - Pattern Analysis",
      "originalId": "real_world_lodash_pattern_3",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "project-pattern-analysis",
        "referenceId": "lodash - Pattern Analysis",
        "sourceUrl": "https://github.com/lodash/lodash",
        "sourceLabel": "lodash - Pattern Analysis",
        "sourceProject": "lodash",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "real_world_lodash_pattern_7",
    "name": "Input Validation - Vulnerability pattern found in lodash",
    "code": "// Extracted from real project file\n// Line 5:   var basePath = '../';\n// Line 6: \n// Line 7:   /** The lodash build to load. */\n// Line 8:   var build = (build = /build=([^&]+)/.exec(location.search)) && decodeURIComponent(build[1]);\n// Line 9: \n// Line 10:   /** The module loader to use. */\n// Line 11:   var loader = (loader = /loader=([^&]+)/.exec(location.search)) && decodeURIComponent(loader[1]);\n// Line 12: \n// Line 13:   /** The `ui` object. */\n// Line 14:   var ui = {};",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Input Validation",
        "cwe": "CWE-20",
        "severity": "medium",
        "description": "Vulnerability pattern found in lodash"
      }
    ],
    "expectedFix": "Validate and sanitize all untrusted input before use.",
    "metadata": {
      "sourceDataset": "real-world",
      "sourcePolicy": "all",
      "source": "lodash - Pattern Analysis",
      "originalId": "real_world_lodash_pattern_7",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "project-pattern-analysis",
        "referenceId": "lodash - Pattern Analysis",
        "sourceUrl": "https://github.com/lodash/lodash",
        "sourceLabel": "lodash - Pattern Analysis",
        "sourceProject": "lodash",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "real_world_lodash_pattern_9",
    "name": "Input Validation - Vulnerability pattern found in lodash",
    "code": "// Extracted from real project file\n// Line 47: var o=n[r],f=t?t(o):o;if(!r||!Gf(f,c)){var c=f;i[u++]=0===o?0:o}}return i}function _u(n){return\"number\"==typeof n?n:bc(n)?Cn:+n}function vu(n){if(\"string\"==typeof n)return n;if(bh(n))return c(n,vu)+\"\";if(bc(n))return vs?vs.call(n):\"\";var t=n+\"\";return\"0\"==t&&1/n==-Sn?\"-0\":t}function gu(n,t,r){var e=-1,u=o,i=n.length,c=!0,a=[],l=a;if(r)c=!1,u=f;else if(i>=tn){var s=t?null:ks(n);if(s)return P(s);c=!1,u=S,l=new yr}else l=t?[]:a;n:for(;++e<i;){var h=n[e],p=t?t(h):h;if(h=r||0!==h?h:0,c&&p===p){for(var _=l.length;_--;)if(l[_]===p)continue n;\n// Line 48: t&&l.push(p),a.push(h)}else u(l,p,r)||(l!==a&&l.push(p),a.push(h))}return a}function yu(n,t){return t=ku(t,n),n=Gi(n,t),null==n||delete n[no(jo(t))]}function du(n,t,r,e){return fu(n,t,r(_e(n,t)),e)}function bu(n,t,r,e){for(var u=n.length,i=e?u:-1;(e?i--:++i<u)&&t(n[i],i,n););return r?au(n,e?0:i,e?i+1:u):au(n,e?i+1:0,e?u:i)}function wu(n,t){var r=n;return r instanceof Ct&&(r=r.value()),l(t,function(n,t){return t.func.apply(t.thisArg,a([n],t.args))},r)}function mu(n,t,r){var e=n.length;if(e<2)return e?gu(n[0]):[];\n// Line 49: for(var u=-1,i=il(e);++u<e;)for(var o=n[u],f=-1;++f<e;)f!=u&&(i[u]=Hr(i[u]||o,n[f],t,r));return gu(ee(i,1),t,r)}function xu(n,t,r){for(var e=-1,u=n.length,i=t.length,o={};++e<u;){r(o,n[e],e<i?t[e]:X)}return o}function ju(n){return Jf(n)?n:[]}function Au(n){return\"function\"==typeof n?n:La}function ku(n,t){return bh(n)?n:Bi(n,t)?[n]:Cs(Ec(n))}function Ou(n,t,r){var e=n.length;return r=r===X?e:r,!t&&r>=e?n:au(n,t,r)}function Iu(n,t){if(t)return n.slice();var r=n.length,e=zl?zl(r):new n.constructor(r);\n// Line 50: return n.copy(e),e}function Ru(n){var t=new n.constructor(n.byteLength);return new Rl(t).set(new Rl(n)),t}function zu(n,t){return new n.constructor(t?Ru(n.buffer):n.buffer,n.byteOffset,n.byteLength)}function Eu(n){var t=new n.constructor(n.source,Nt.exec(n));return t.lastIndex=n.lastIndex,t}function Su(n){return _s?ll(_s.call(n)):{}}function Wu(n,t){return new n.constructor(t?Ru(n.buffer):n.buffer,n.byteOffset,n.length)}function Lu(n,t){if(n!==t){var r=n!==X,e=null===n,u=n===n,i=bc(n),o=t!==X,f=null===t,c=t===t,a=bc(t);\n// Line 51: if(!f&&!a&&!i&&n>t||i&&o&&c&&!f&&!a||e&&o&&c||!r&&c||!u)return 1;if(!e&&!i&&!a&&n<t||a&&r&&u&&!e&&!i||f&&r&&u||!o&&u||!c)return-1}return 0}function Cu(n,t,r){for(var e=-1,u=n.criteria,i=t.criteria,o=u.length,f=r.length;++e<o;){var c=Lu(u[e],i[e]);if(c){if(e>=f)return c;return c*(\"desc\"==r[e]?-1:1)}}return n.index-t.index}function Uu(n,t,r,e){for(var u=-1,i=n.length,o=r.length,f=-1,c=t.length,a=Gl(i-o,0),l=il(c+a),s=!e;++f<c;)l[f]=t[f];for(;++u<o;)(s||u<i)&&(l[r[u]]=n[u]);for(;a--;)l[f++]=n[u++];return l;\n// Line 52: }function Bu(n,t,r,e){for(var u=-1,i=n.length,o=-1,f=r.length,c=-1,a=t.length,l=Gl(i-f,0),s=il(l+a),h=!e;++u<l;)s[u]=n[u];for(var p=u;++c<a;)s[p+c]=t[c];for(;++o<f;)(h||u<i)&&(s[p+r[o]]=n[u++]);return s}function Tu(n,t){var r=-1,e=n.length;for(t||(t=il(e));++r<e;)t[r]=n[r];return t}function $u(n,t,r,e){var u=!r;r||(r={});for(var i=-1,o=t.length;++i<o;){var f=t[i],c=e?e(r[f],n[f],f,r,n):X;c===X&&(c=n[f]),u?Br(r,f,c):Sr(r,f,c)}return r}function Du(n,t){return $u(n,Is(n),t)}function Mu(n,t){return $u(n,Rs(n),t);\n// Line 53: }function Fu(n,r){return function(e,u){var i=bh(e)?t:Lr,o=r?r():{};return i(e,n,mi(u,2),o)}}function Nu(n){return uu(function(t,r){var e=-1,u=r.length,i=u>1?r[u-1]:X,o=u>2?r[2]:X;for(i=n.length>3&&\"function\"==typeof i?(u--,i):X,o&&Ui(r[0],r[1],o)&&(i=u<3?X:i,u=1),t=ll(t);++e<u;){var f=r[e];f&&n(t,f,e,i)}return t})}function Pu(n,t){return function(r,e){if(null==r)return r;if(!Hf(r))return n(r,e);for(var u=r.length,i=t?u:-1,o=ll(r);(t?i--:++i<u)&&e(o[i],i,o)!==!1;);return r}}function qu(n){return function(t,r,e){\n// Line 54: for(var u=-1,i=ll(t),o=e(t),f=o.length;f--;){var c=o[n?f:++u];if(r(i[c],c,i)===!1)break}return t}}function Zu(n,t,r){function e(){return(this&&this!==re&&this instanceof e?i:n).apply(u?r:this,arguments)}var u=t&_n,i=Gu(n);return e}function Ku(n){return function(t){t=Ec(t);var r=T(t)?G(t):X,e=r?r[0]:t.charAt(0),u=r?Ou(r,1).join(\"\"):t.slice(1);return e[n]()+u}}function Vu(n){return function(t){return l(Ra(ca(t).replace($r,\"\")),n,\"\")}}function Gu(n){return function(){var t=arguments;switch(t.length){\n// Line 55: case 0:return new n;case 1:return new n(t[0]);case 2:return new n(t[0],t[1]);case 3:return new n(t[0],t[1],t[2]);case 4:return new n(t[0],t[1],t[2],t[3]);case 5:return new n(t[0],t[1],t[2],t[3],t[4]);case 6:return new n(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new n(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=gs(n.prototype),e=n.apply(r,t);return fc(e)?e:r}}function Hu(t,r,e){function u(){for(var o=arguments.length,f=il(o),c=o,a=wi(u);c--;)f[c]=arguments[c];var l=o<3&&f[0]!==a&&f[o-1]!==a?[]:N(f,a);\n// Line 56: return o-=l.length,o<e?oi(t,r,Qu,u.placeholder,X,f,l,X,X,e-o):n(this&&this!==re&&this instanceof u?i:t,this,f)}var i=Gu(t);return u}function Ju(n){return function(t,r,e){var u=ll(t);if(!Hf(t)){var i=mi(r,3);t=Pc(t),r=function(n){return i(u[n],n,u)}}var o=n(t,r,e);return o>-1?u[i?t[o]:o]:X}}function Yu(n){return gi(function(t){var r=t.length,e=r,u=Y.prototype.thru;for(n&&t.reverse();e--;){var i=t[e];if(\"function\"!=typeof i)throw new pl(en);if(u&&!o&&\"wrapper\"==bi(i))var o=new Y([],!0)}for(e=o?e:r;++e<r;){",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Input Validation",
        "cwe": "CWE-20",
        "severity": "medium",
        "description": "Vulnerability pattern found in lodash"
      }
    ],
    "expectedFix": "Validate and sanitize all untrusted input before use.",
    "metadata": {
      "sourceDataset": "real-world",
      "sourcePolicy": "all",
      "source": "lodash - Pattern Analysis",
      "originalId": "real_world_lodash_pattern_9",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "project-pattern-analysis",
        "referenceId": "lodash - Pattern Analysis",
        "sourceUrl": "https://github.com/lodash/lodash",
        "sourceLabel": "lodash - Pattern Analysis",
        "sourceProject": "lodash",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "real_world_node-forge_cve_2022_24771",
    "name": "Crypto Verification - Real CVE-2022-24771 vulnerability in node-forge",
    "code": "// Real CVE-2022-24771 in node-forge\nconst crypto = require('crypto');\n\nfunction verifySignature(message, signature, publicKey) {\n    try {\n        // VULNERABILITY: Improper signature verification\n        const verify = crypto.createVerify('RSA-SHA256');\n        verify.update(message);\n        \n        // Missing proper signature format validation\n        return verify.verify(publicKey, signature, 'base64');\n    } catch (error) {\n        // Silently return true on error (vulnerable behavior)\n        return true;\n    }\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Crypto Verification",
        "cwe": "CWE-347",
        "severity": "high",
        "description": "Real CVE-2022-24771 vulnerability in node-forge"
      }
    ],
    "expectedFix": "Use constant-time comparison and verified cryptographic APIs.",
    "metadata": {
      "sourceDataset": "real-world",
      "sourcePolicy": "all",
      "source": "node-forge - CVE-2022-24771",
      "originalId": "real_world_node-forge_cve_2022_24771",
      "vulnerableLines": [
        8,
        9
      ],
      "provenance": {
        "sourceType": "cve",
        "referenceId": "CVE-2022-24771",
        "sourceUrl": "https://nvd.nist.gov/vuln/detail/CVE-2022-24771",
        "sourceLabel": "node-forge - CVE-2022-24771",
        "sourceProject": "node-forge",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "real_world_react-dom_pattern_9",
    "name": "Input Validation - Vulnerability pattern found in react-dom",
    "code": "// Extracted from real project file\n// Line 15: \n// Line 16: function executeCommand(command) {\n// Line 17:   return new Promise(_resolve =>\n// Line 18:     exec(command, error => {\n// Line 19:       if (!error) {\n// Line 20:         _resolve();\n// Line 21:       } else {\n// Line 22:         console.error(error);\n// Line 23:         process.exit(1);\n// Line 24:       }",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Input Validation",
        "cwe": "CWE-20",
        "severity": "medium",
        "description": "Vulnerability pattern found in react-dom"
      }
    ],
    "expectedFix": "Validate and sanitize all untrusted input before use.",
    "metadata": {
      "sourceDataset": "real-world",
      "sourcePolicy": "all",
      "source": "react-dom - Pattern Analysis",
      "originalId": "real_world_react-dom_pattern_9",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "project-pattern-analysis",
        "referenceId": "react-dom - Pattern Analysis",
        "sourceUrl": "https://github.com/facebook/react",
        "sourceLabel": "react-dom - Pattern Analysis",
        "sourceProject": "react-dom",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "real_world_serialize-javascript_pattern_2",
    "name": "Input Validation - Vulnerability pattern found in serialize-javascript",
    "code": "// Extracted from real project file\n// Line 31:         });\n// Line 32: \n// Line 33:         it('should deserialize \"undefined\" to `undefined`', function () {\n// Line 34:             strictEqual(eval(serialize()), undefined);\n// Line 35:             strictEqual(eval(serialize(undefined)), undefined);\n// Line 36:         });\n// Line 37:     });\n// Line 38: \n// Line 39:     describe('null', function () {\n// Line 40:         it('should serialize `null` to a string', function () {",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Input Validation",
        "cwe": "CWE-20",
        "severity": "medium",
        "description": "Vulnerability pattern found in serialize-javascript"
      }
    ],
    "expectedFix": "Validate and sanitize all untrusted input before use.",
    "metadata": {
      "sourceDataset": "real-world",
      "sourcePolicy": "all",
      "source": "serialize-javascript - Pattern Analysis",
      "originalId": "real_world_serialize-javascript_pattern_2",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "project-pattern-analysis",
        "referenceId": "serialize-javascript - Pattern Analysis",
        "sourceUrl": "https://github.com/yahoo/serialize-javascript",
        "sourceLabel": "serialize-javascript - Pattern Analysis",
        "sourceProject": "serialize-javascript",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "real_world_moment_pattern_1",
    "name": "Input Validation - Vulnerability pattern found in moment",
    "code": "// Extracted from real project file\n// Line 2428:         var i,\n// Line 2429:             l,\n// Line 2430:             string = config._i,\n// Line 2431:             match = extendedIsoRegex.exec(string) || basicIsoRegex.exec(string),\n// Line 2432:             allowTime,\n// Line 2433:             dateFormat,\n// Line 2434:             timeFormat,\n// Line 2435:             tzFormat,\n// Line 2436:             isoDatesLen = isoDates.length,\n// Line 2437:             isoTimesLen = isoTimes.length;",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Input Validation",
        "cwe": "CWE-20",
        "severity": "medium",
        "description": "Vulnerability pattern found in moment"
      }
    ],
    "expectedFix": "Validate and sanitize all untrusted input before use.",
    "metadata": {
      "sourceDataset": "real-world",
      "sourcePolicy": "all",
      "source": "moment - Pattern Analysis",
      "originalId": "real_world_moment_pattern_1",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "project-pattern-analysis",
        "referenceId": "moment - Pattern Analysis",
        "sourceUrl": "https://github.com/moment/moment",
        "sourceLabel": "moment - Pattern Analysis",
        "sourceProject": "moment",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "real_world_mongoose_pattern_7",
    "name": "Input Validation - Vulnerability pattern found in mongoose",
    "code": "// Extracted from real project file\n// Line 974:     const n = await N.create({ g: m._id });\n// Line 975:     const o = await O.create({ i: n._id });\n// Line 976: \n// Line 977:     const doc = await O.findOne({ _id: o._id }).populate('i').exec();\n// Line 978:     const finalDoc = await doc.populate('i.g');\n// Line 979: \n// Line 980:     assert.ok(finalDoc.populated('i.g'));\n// Line 981:     assert.ok(finalDoc.i.populated('g'));\n// Line 982:   });\n// Line 983: ",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Input Validation",
        "cwe": "CWE-20",
        "severity": "medium",
        "description": "Vulnerability pattern found in mongoose"
      }
    ],
    "expectedFix": "Validate and sanitize all untrusted input before use.",
    "metadata": {
      "sourceDataset": "real-world",
      "sourcePolicy": "all",
      "source": "mongoose - Pattern Analysis",
      "originalId": "real_world_mongoose_pattern_7",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "project-pattern-analysis",
        "referenceId": "mongoose - Pattern Analysis",
        "sourceUrl": "https://github.com/Automattic/mongoose",
        "sourceLabel": "mongoose - Pattern Analysis",
        "sourceProject": "mongoose",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_sqli_parameter_injection_original",
    "name": "SQL Injection - Adversarial test: SQL injection through parameter manipulation",
    "code": "// Adversarial: Multiple injection vectors\nfunction complexQuery(userId, role, filters) {\n    const query = `\n        SELECT u.*, r.permissions \n        FROM users u \n        JOIN roles r ON u.role_id = r.id \n        WHERE u.id = ${userId} \n        AND r.name = '${role}'\n        ${filters.where ? 'AND ' + filters.where : ''}\n        ORDER BY ${filters.orderBy || 'u.created_at'}\n    `;\n    return db.query(query);\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "SQL Injection",
        "cwe": "CWE-89",
        "severity": "high",
        "description": "Adversarial test: SQL injection through parameter manipulation"
      }
    ],
    "expectedFix": "Use parameterized SQL queries or prepared statements.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Original Pattern",
      "originalId": "adversarial_sqli_parameter_injection_original",
      "vulnerableLines": [
        12
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Original Pattern",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Original Pattern",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_sqli_parameter_injection_obfuscated",
    "name": "SQL Injection - Adversarial test (obfuscated): SQL injection through parameter manipulation",
    "code": "// Obfuscated vulnerability pattern\n// Adversarial: Multiple injection vectors\nfunction complexQuery(userId, role, filters) {\n    const query = `\n        SELECT u.*, r.permissions \n        FROM users u \n        JOIN roles r ON u.role_id = r.id \n        WHERE u.id = ${userId} \n        AND r.name = '${role}'\n        ${filters.where ? 'AND ' + filters.where : ''}\n        ORDER BY ${filters.orderBy || 'u.created_at'}\n    `;\n    return db.query(query);\n}\n\n// Additional obfuscation layers\nconst obfuscatedFunc = Function.prototype.constructor;\nconst dynamicEval = obfuscatedFunc.constructor(\"return eval\")();\n",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "SQL Injection",
        "cwe": "CWE-89",
        "severity": "high",
        "description": "Adversarial test (obfuscated): SQL injection through parameter manipulation"
      }
    ],
    "expectedFix": "Use parameterized SQL queries or prepared statements.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Obfuscated",
      "originalId": "adversarial_sqli_parameter_injection_obfuscated",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Obfuscated",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Obfuscated",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_sqli_parameter_injection_minimal",
    "name": "SQL Injection - Adversarial test (minimal): SQL injection through parameter manipulation",
    "code": "function query(id) { return db.exec(\"SELECT * FROM users WHERE id=\" + id); }",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "SQL Injection",
        "cwe": "CWE-89",
        "severity": "medium",
        "description": "Adversarial test (minimal): SQL injection through parameter manipulation"
      }
    ],
    "expectedFix": "Use parameterized SQL queries or prepared statements.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Minimal",
      "originalId": "adversarial_sqli_parameter_injection_minimal",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Minimal",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Minimal",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_xss_context_switching_original",
    "name": "Cross-Site Scripting (XSS) - Adversarial test: XSS with context switching",
    "code": "// Adversarial: Context-aware XSS\nfunction renderUserProfile(user, template) {\n    const profileHtml = template\n        .replace('{{name}}', user.name)\n        .replace('{{bio}}', user.bio)\n        .replace('{{avatar}}', user.avatar);\n    \n    // Context switching vulnerability\n    if (user.isAdmin) {\n        profileHtml += `<script>window.userRole='${user.role}';</script>`;\n    }\n    \n    document.getElementById('profile').innerHTML = profileHtml;\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Cross-Site Scripting (XSS)",
        "cwe": "CWE-79",
        "severity": "high",
        "description": "Adversarial test: XSS with context switching"
      }
    ],
    "expectedFix": "Escape/sanitize untrusted content and avoid unsafe DOM sinks.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Original Pattern",
      "originalId": "adversarial_xss_context_switching_original",
      "vulnerableLines": [
        13
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Original Pattern",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Original Pattern",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_xss_context_switching_obfuscated",
    "name": "Cross-Site Scripting (XSS) - Adversarial test (obfuscated): XSS with context switching",
    "code": "// Obfuscated vulnerability pattern\n// Adversarial: Context-aware XSS\nfunction renderUserProfile(user, template) {\n    const profileHtml = template\n        .replace('{{name}}', user.name)\n        .replace('{{bio}}', user.bio)\n        .replace('{{avatar}}', user.avatar);\n    \n    // Context switching vulnerability\n    if (user.isAdmin) {\n        profileHtml += `<script>window.userRole='${user.role}';</script>`;\n    }\n    \n    document.getElementById('profile').innerHTML = profileHtml;\n}\n\n// Additional obfuscation layers\nconst obfuscatedFunc = Function.prototype.constructor;\nconst dynamicEval = obfuscatedFunc.constructor(\"return eval\")();\n",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Cross-Site Scripting (XSS)",
        "cwe": "CWE-79",
        "severity": "high",
        "description": "Adversarial test (obfuscated): XSS with context switching"
      }
    ],
    "expectedFix": "Escape/sanitize untrusted content and avoid unsafe DOM sinks.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Obfuscated",
      "originalId": "adversarial_xss_context_switching_obfuscated",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Obfuscated",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Obfuscated",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_xss_context_switching_minimal",
    "name": "Cross-Site Scripting (XSS) - Adversarial test (minimal): XSS with context switching",
    "code": "function render(html) { document.body.innerHTML = html; }",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Cross-Site Scripting (XSS)",
        "cwe": "CWE-79",
        "severity": "medium",
        "description": "Adversarial test (minimal): XSS with context switching"
      }
    ],
    "expectedFix": "Escape/sanitize untrusted content and avoid unsafe DOM sinks.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Minimal",
      "originalId": "adversarial_xss_context_switching_minimal",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Minimal",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Minimal",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_path_traversal_double_encoding_original",
    "name": "Path Traversal - Adversarial test: Path traversal with encoding bypass",
    "code": "// Adversarial: Multiple encoding bypass\nconst path = require('path');\nconst fs = require('fs');\n\nfunction serveUserFile(filename, encoding = 'utf8') {\n    // Multiple normalization attempts\n    let sanitized = filename\n        .replace(/\\.\\./g, '')\n        .replace(/\\\\/g, '/')\n        .replace(/\\/+/g, '/');\n    \n    // Still vulnerable to double encoding\n    const filePath = path.join('./uploads', decodeURIComponent(sanitized));\n    return fs.readFileSync(filePath, encoding);\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Path Traversal",
        "cwe": "CWE-22",
        "severity": "high",
        "description": "Adversarial test: Path traversal with encoding bypass"
      }
    ],
    "expectedFix": "Canonicalize paths and restrict access to approved directories.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Original Pattern",
      "originalId": "adversarial_path_traversal_double_encoding_original",
      "vulnerableLines": [
        2,
        3,
        14
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Original Pattern",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Original Pattern",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_path_traversal_double_encoding_obfuscated",
    "name": "Path Traversal - Adversarial test (obfuscated): Path traversal with encoding bypass",
    "code": "// Obfuscated vulnerability pattern\n// Adversarial: Multiple encoding bypass\nconst path = require('path');\nconst fs = require('fs');\n\nfunction serveUserFile(filename, encoding = 'utf8') {\n    // Multiple normalization attempts\n    let sanitized = filename\n        .replace(/\\.\\./g, '')\n        .replace(/\\\\/g, '/')\n        .replace(/\\/+/g, '/');\n    \n    // Still vulnerable to double encoding\n    const filePath = path.join('./uploads', decodeURIComponent(sanitized));\n    return fs.readFileSync(filePath, encoding);\n}\n\n// Additional obfuscation layers\nconst obfuscatedFunc = Function.prototype.constructor;\nconst dynamicEval = obfuscatedFunc.constructor(\"return eval\")();\n",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Path Traversal",
        "cwe": "CWE-22",
        "severity": "high",
        "description": "Adversarial test (obfuscated): Path traversal with encoding bypass"
      }
    ],
    "expectedFix": "Canonicalize paths and restrict access to approved directories.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Obfuscated",
      "originalId": "adversarial_path_traversal_double_encoding_obfuscated",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Obfuscated",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Obfuscated",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_path_traversal_double_encoding_minimal",
    "name": "Path Traversal - Adversarial test (minimal): Path traversal with encoding bypass",
    "code": "function readFile(path) { return fs.readFileSync(\"./files/\" + path); }",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Path Traversal",
        "cwe": "CWE-22",
        "severity": "medium",
        "description": "Adversarial test (minimal): Path traversal with encoding bypass"
      }
    ],
    "expectedFix": "Canonicalize paths and restrict access to approved directories.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Minimal",
      "originalId": "adversarial_path_traversal_double_encoding_minimal",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Minimal",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Minimal",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_prototype_pollution_nested_original",
    "name": "Prototype Pollution - Adversarial test: Nested prototype pollution",
    "code": "// Adversarial: Deep nested pollution\nfunction deepMergeConfig(target, source, depth = 0) {\n    if (depth > 10) return target; // Recursion limit\n    \n    for (const key in source) {\n        if (source[key] && typeof source[key] === 'object') {\n            if (!target[key]) target[key] = {};\n            deepMergeConfig(target[key], source[key], depth + 1);\n        } else {\n            target[key] = source[key]; // Pollution vector\n        }\n    }\n    return target;\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Prototype Pollution",
        "cwe": "CWE-1321",
        "severity": "high",
        "description": "Adversarial test: Nested prototype pollution"
      }
    ],
    "expectedFix": "Block dangerous keys and clone/validate objects before merge operations.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Original Pattern",
      "originalId": "adversarial_prototype_pollution_nested_original",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Original Pattern",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Original Pattern",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_prototype_pollution_nested_obfuscated",
    "name": "Prototype Pollution - Adversarial test (obfuscated): Nested prototype pollution",
    "code": "// Obfuscated vulnerability pattern\n// Adversarial: Deep nested pollution\nfunction deepMergeConfig(target, source, depth = 0) {\n    if (depth > 10) return target; // Recursion limit\n    \n    for (const key in source) {\n        if (source[key] && typeof source[key] === 'object') {\n            if (!target[key]) target[key] = {};\n            deepMergeConfig(target[key], source[key], depth + 1);\n        } else {\n            target[key] = source[key]; // Pollution vector\n        }\n    }\n    return target;\n}\n\n// Additional obfuscation layers\nconst obfuscatedFunc = Function.prototype.constructor;\nconst dynamicEval = obfuscatedFunc.constructor(\"return eval\")();\n",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Prototype Pollution",
        "cwe": "CWE-1321",
        "severity": "high",
        "description": "Adversarial test (obfuscated): Nested prototype pollution"
      }
    ],
    "expectedFix": "Block dangerous keys and clone/validate objects before merge operations.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Obfuscated",
      "originalId": "adversarial_prototype_pollution_nested_obfuscated",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Obfuscated",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Obfuscated",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_prototype_pollution_nested_minimal",
    "name": "Prototype Pollution - Adversarial test (minimal): Nested prototype pollution",
    "code": "function merge(obj, src) { for(let k in src) obj[k] = src[k]; }",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Prototype Pollution",
        "cwe": "CWE-1321",
        "severity": "medium",
        "description": "Adversarial test (minimal): Nested prototype pollution"
      }
    ],
    "expectedFix": "Block dangerous keys and clone/validate objects before merge operations.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Minimal",
      "originalId": "adversarial_prototype_pollution_nested_minimal",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Minimal",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Minimal",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_command_injection_template_original",
    "name": "Command Injection - Adversarial test: Command injection through template processing",
    "code": "// Adversarial: Template-based command injection\nconst { exec } = require('child_process');\n\nfunction processTemplate(template, data) {\n    // Template processing with command execution\n    const processed = template.replace(/\\\\{\\\\{([^}]+)\\\\}\\\\}/g, (match, expr) => {\n        try {\n            // Dangerous evaluation\n            return Function('\"use strict\"; return (' + expr + ')')();\n        } catch {\n            return match;\n        }\n    });\n    \n    if (data.executeCommand) {\n        exec(`echo \"${processed}\" > output.txt`);\n    }\n    \n    return processed;\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Command Injection",
        "cwe": "CWE-78",
        "severity": "high",
        "description": "Adversarial test: Command injection through template processing"
      }
    ],
    "expectedFix": "Use safe process APIs and never concatenate untrusted input into commands.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Original Pattern",
      "originalId": "adversarial_command_injection_template_original",
      "vulnerableLines": [
        2,
        9,
        16
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Original Pattern",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Original Pattern",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_command_injection_template_obfuscated",
    "name": "Command Injection - Adversarial test (obfuscated): Command injection through template processing",
    "code": "// Obfuscated vulnerability pattern\n// Adversarial: Template-based command injection\nconst { exec } = require('child_process');\n\nfunction processTemplate(template, data) {\n    // Template processing with command execution\n    const processed = template.replace(/\\\\{\\\\{([^}]+)\\\\}\\\\}/g, (match, expr) => {\n        try {\n            // Dangerous evaluation\n            return Function('\"use strict\"; return (' + expr + ')')();\n        } catch {\n            return match;\n        }\n    });\n    \n    if (data.executeCommand) {\n        exec(`echo \"${processed}\" > output.txt`);\n    }\n    \n    return processed;\n}\n\n// Additional obfuscation layers\nconst obfuscatedFunc = Function.prototype.constructor;\nconst dynamicEval = obfuscatedFunc.constructor(\"return eval\")();\n",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Command Injection",
        "cwe": "CWE-78",
        "severity": "high",
        "description": "Adversarial test (obfuscated): Command injection through template processing"
      }
    ],
    "expectedFix": "Use safe process APIs and never concatenate untrusted input into commands.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Obfuscated",
      "originalId": "adversarial_command_injection_template_obfuscated",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Obfuscated",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Obfuscated",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_command_injection_template_minimal",
    "name": "Command Injection - Adversarial test (minimal): Command injection through template processing",
    "code": "function exec(cmd) { require(\"child_process\").exec(cmd); }",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Command Injection",
        "cwe": "CWE-78",
        "severity": "medium",
        "description": "Adversarial test (minimal): Command injection through template processing"
      }
    ],
    "expectedFix": "Use safe process APIs and never concatenate untrusted input into commands.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Minimal",
      "originalId": "adversarial_command_injection_template_minimal",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Minimal",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Minimal",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_crypto_timing_attack_original",
    "name": "Weak Cryptography - Adversarial test: Cryptographic timing attack",
    "code": "// Adversarial: Timing attack vulnerability\nfunction verifyApiKey(providedKey, validKey) {\n    if (providedKey.length !== validKey.length) {\n        return false;\n    }\n    \n    // Vulnerable: Early termination allows timing attacks\n    for (let i = 0; i < providedKey.length; i++) {\n        if (providedKey[i] !== validKey[i]) {\n            return false; // Timing leak here\n        }\n    }\n    \n    return true;\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Weak Cryptography",
        "cwe": "CWE-208",
        "severity": "high",
        "description": "Adversarial test: Cryptographic timing attack"
      }
    ],
    "expectedFix": "Replace weak cryptographic primitives with modern approved algorithms.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Original Pattern",
      "originalId": "adversarial_crypto_timing_attack_original",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Original Pattern",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Original Pattern",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_crypto_timing_attack_obfuscated",
    "name": "Weak Cryptography - Adversarial test (obfuscated): Cryptographic timing attack",
    "code": "// Obfuscated vulnerability pattern\n// Adversarial: Timing attack vulnerability\nfunction verifyApiKey(providedKey, validKey) {\n    if (providedKey.length !== validKey.length) {\n        return false;\n    }\n    \n    // Vulnerable: Early termination allows timing attacks\n    for (let i = 0; i < providedKey.length; i++) {\n        if (providedKey[i] !== validKey[i]) {\n            return false; // Timing leak here\n        }\n    }\n    \n    return true;\n}\n\n// Additional obfuscation layers\nconst obfuscatedFunc = Function.prototype.constructor;\nconst dynamicEval = obfuscatedFunc.constructor(\"return eval\")();\n",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Weak Cryptography",
        "cwe": "CWE-208",
        "severity": "high",
        "description": "Adversarial test (obfuscated): Cryptographic timing attack"
      }
    ],
    "expectedFix": "Replace weak cryptographic primitives with modern approved algorithms.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Obfuscated",
      "originalId": "adversarial_crypto_timing_attack_obfuscated",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Obfuscated",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Obfuscated",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_crypto_timing_attack_minimal",
    "name": "Weak Cryptography - Adversarial test (minimal): Cryptographic timing attack",
    "code": "function compare(a, b) { return a === b; }",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Weak Cryptography",
        "cwe": "CWE-208",
        "severity": "medium",
        "description": "Adversarial test (minimal): Cryptographic timing attack"
      }
    ],
    "expectedFix": "Replace weak cryptographic primitives with modern approved algorithms.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Minimal",
      "originalId": "adversarial_crypto_timing_attack_minimal",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Minimal",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Minimal",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_deserialization_gadget_original",
    "name": "Insecure Deserialization - Adversarial test: Unsafe deserialization with gadget chain",
    "code": "// Adversarial: Deserialization gadget chain\nclass UserSession {\n    constructor(data) {\n        Object.assign(this, data);\n    }\n    \n    toJSON() {\n        return { ...this, serializedAt: Date.now() };\n    }\n    \n    static fromJSON(jsonStr) {\n        const data = JSON.parse(jsonStr);\n        // Vulnerable: Automatic property assignment\n        return new UserSession(data);\n    }\n}\n\nfunction loadUserSession(sessionData) {\n    return UserSession.fromJSON(sessionData);\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Insecure Deserialization",
        "cwe": "CWE-502",
        "severity": "high",
        "description": "Adversarial test: Unsafe deserialization with gadget chain"
      }
    ],
    "expectedFix": "Avoid unsafe deserialization and enforce strict schema validation.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Original Pattern",
      "originalId": "adversarial_deserialization_gadget_original",
      "vulnerableLines": [
        4,
        12
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Original Pattern",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Original Pattern",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_deserialization_gadget_obfuscated",
    "name": "Insecure Deserialization - Adversarial test (obfuscated): Unsafe deserialization with gadget chain",
    "code": "// Obfuscated vulnerability pattern\n// Adversarial: Deserialization gadget chain\nclass UserSession {\n    constructor(data) {\n        Object.assign(this, data);\n    }\n    \n    toJSON() {\n        return { ...this, serializedAt: Date.now() };\n    }\n    \n    static fromJSON(jsonStr) {\n        const data = JSON.parse(jsonStr);\n        // Vulnerable: Automatic property assignment\n        return new UserSession(data);\n    }\n}\n\nfunction loadUserSession(sessionData) {\n    return UserSession.fromJSON(sessionData);\n}\n\n// Additional obfuscation layers\nconst obfuscatedFunc = Function.prototype.constructor;\nconst dynamicEval = obfuscatedFunc.constructor(\"return eval\")();\n",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Insecure Deserialization",
        "cwe": "CWE-502",
        "severity": "high",
        "description": "Adversarial test (obfuscated): Unsafe deserialization with gadget chain"
      }
    ],
    "expectedFix": "Avoid unsafe deserialization and enforce strict schema validation.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Obfuscated",
      "originalId": "adversarial_deserialization_gadget_obfuscated",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Obfuscated",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Obfuscated",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_deserialization_gadget_minimal",
    "name": "Insecure Deserialization - Adversarial test (minimal): Unsafe deserialization with gadget chain",
    "code": "function load(data) { return Object.assign({}, JSON.parse(data)); }",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Insecure Deserialization",
        "cwe": "CWE-502",
        "severity": "medium",
        "description": "Adversarial test (minimal): Unsafe deserialization with gadget chain"
      }
    ],
    "expectedFix": "Avoid unsafe deserialization and enforce strict schema validation.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Minimal",
      "originalId": "adversarial_deserialization_gadget_minimal",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Minimal",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Minimal",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_nosql_injection_aggregation_original",
    "name": "NoSQL Injection - Adversarial test: NoSQL injection in aggregation pipeline",
    "code": "// Adversarial: NoSQL injection via aggregation\nfunction getUserAnalytics(userId, filters) {\n    const pipeline = [\n        { $match: { userId: userId } },\n        { $group: { _id: \"$category\", total: { $sum: 1 } } }\n    ];\n    \n    // Vulnerable: Direct filter injection\n    if (filters.customStage) {\n        pipeline.push(JSON.parse(filters.customStage));\n    }\n    \n    return db.collection('events').aggregate(pipeline).toArray();\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "NoSQL Injection",
        "cwe": "CWE-943",
        "severity": "high",
        "description": "Adversarial test: NoSQL injection in aggregation pipeline"
      }
    ],
    "expectedFix": "Use parameterized query objects and validate query operators/fields.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Original Pattern",
      "originalId": "adversarial_nosql_injection_aggregation_original",
      "vulnerableLines": [
        10
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Original Pattern",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Original Pattern",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_nosql_injection_aggregation_obfuscated",
    "name": "NoSQL Injection - Adversarial test (obfuscated): NoSQL injection in aggregation pipeline",
    "code": "// Obfuscated vulnerability pattern\n// Adversarial: NoSQL injection via aggregation\nfunction getUserAnalytics(userId, filters) {\n    const pipeline = [\n        { $match: { userId: userId } },\n        { $group: { _id: \"$category\", total: { $sum: 1 } } }\n    ];\n    \n    // Vulnerable: Direct filter injection\n    if (filters.customStage) {\n        pipeline.push(JSON.parse(filters.customStage));\n    }\n    \n    return db.collection('events').aggregate(pipeline).toArray();\n}\n\n// Additional obfuscation layers\nconst obfuscatedFunc = Function.prototype.constructor;\nconst dynamicEval = obfuscatedFunc.constructor(\"return eval\")();\n",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "NoSQL Injection",
        "cwe": "CWE-943",
        "severity": "high",
        "description": "Adversarial test (obfuscated): NoSQL injection in aggregation pipeline"
      }
    ],
    "expectedFix": "Use parameterized query objects and validate query operators/fields.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Obfuscated",
      "originalId": "adversarial_nosql_injection_aggregation_obfuscated",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Obfuscated",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Obfuscated",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_nosql_injection_aggregation_minimal",
    "name": "NoSQL Injection - Adversarial test (minimal): NoSQL injection in aggregation pipeline",
    "code": "function vuln() { /* minimal vulnerability */ }",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "NoSQL Injection",
        "cwe": "CWE-943",
        "severity": "medium",
        "description": "Adversarial test (minimal): NoSQL injection in aggregation pipeline"
      }
    ],
    "expectedFix": "Use parameterized query objects and validate query operators/fields.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Minimal",
      "originalId": "adversarial_nosql_injection_aggregation_minimal",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Minimal",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Minimal",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_regex_dos_backtrack_original",
    "name": "Regular Expression DoS - Adversarial test: ReDoS via catastrophic backtracking",
    "code": "// Adversarial: Regex catastrophic backtracking\nfunction validateEmail(email) {\n    // Vulnerable: Catastrophic backtracking pattern\n    const emailRegex = /^([a-zA-Z0-9_\\-\\.]+)@([a-zA-Z0-9_\\-\\.]+)\\.([a-zA-Z]{2,5})$/;\n    const complexRegex = /^(a+)+b$/;\n    \n    if (complexRegex.test(email)) {\n        return emailRegex.test(email);\n    }\n    \n    return false;\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Regular Expression DoS",
        "cwe": "CWE-1333",
        "severity": "high",
        "description": "Adversarial test: ReDoS via catastrophic backtracking"
      }
    ],
    "expectedFix": "Avoid catastrophic regex patterns and enforce input/time limits.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Original Pattern",
      "originalId": "adversarial_regex_dos_backtrack_original",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Original Pattern",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Original Pattern",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_regex_dos_backtrack_obfuscated",
    "name": "Regular Expression DoS - Adversarial test (obfuscated): ReDoS via catastrophic backtracking",
    "code": "// Obfuscated vulnerability pattern\n// Adversarial: Regex catastrophic backtracking\nfunction validateEmail(email) {\n    // Vulnerable: Catastrophic backtracking pattern\n    const emailRegex = /^([a-zA-Z0-9_\\-\\.]+)@([a-zA-Z0-9_\\-\\.]+)\\.([a-zA-Z]{2,5})$/;\n    const complexRegex = /^(a+)+b$/;\n    \n    if (complexRegex.test(email)) {\n        return emailRegex.test(email);\n    }\n    \n    return false;\n}\n\n// Additional obfuscation layers\nconst obfuscatedFunc = Function.prototype.constructor;\nconst dynamicEval = obfuscatedFunc.constructor(\"return eval\")();\n",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Regular Expression DoS",
        "cwe": "CWE-1333",
        "severity": "high",
        "description": "Adversarial test (obfuscated): ReDoS via catastrophic backtracking"
      }
    ],
    "expectedFix": "Avoid catastrophic regex patterns and enforce input/time limits.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Obfuscated",
      "originalId": "adversarial_regex_dos_backtrack_obfuscated",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Obfuscated",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Obfuscated",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_regex_dos_backtrack_minimal",
    "name": "Regular Expression DoS - Adversarial test (minimal): ReDoS via catastrophic backtracking",
    "code": "function vuln() { /* minimal vulnerability */ }",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Regular Expression DoS",
        "cwe": "CWE-1333",
        "severity": "medium",
        "description": "Adversarial test (minimal): ReDoS via catastrophic backtracking"
      }
    ],
    "expectedFix": "Avoid catastrophic regex patterns and enforce input/time limits.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Minimal",
      "originalId": "adversarial_regex_dos_backtrack_minimal",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Minimal",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Minimal",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_jwt_algorithm_confusion_original",
    "name": "Authentication Bypass - Adversarial test: JWT algorithm confusion attack",
    "code": "// Adversarial: JWT algorithm confusion\nconst jwt = require('jsonwebtoken');\nconst fs = require('fs');\n\nfunction verifyToken(token, publicKey) {\n    try {\n        // Vulnerable: No algorithm specification\n        const decoded = jwt.verify(token, publicKey);\n        return decoded;\n    } catch (error) {\n        // Fallback to 'none' algorithm\n        const parts = token.split('.');\n        if (parts.length === 3) {\n            return JSON.parse(Buffer.from(parts[1], 'base64').toString());\n        }\n        throw error;\n    }\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Authentication Bypass",
        "cwe": "CWE-287",
        "severity": "high",
        "description": "Adversarial test: JWT algorithm confusion attack"
      }
    ],
    "expectedFix": "Harden authentication checks and validate token/session integrity.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Original Pattern",
      "originalId": "adversarial_jwt_algorithm_confusion_original",
      "vulnerableLines": [
        2,
        3,
        14
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Original Pattern",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Original Pattern",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_jwt_algorithm_confusion_obfuscated",
    "name": "Authentication Bypass - Adversarial test (obfuscated): JWT algorithm confusion attack",
    "code": "// Obfuscated vulnerability pattern\n// Adversarial: JWT algorithm confusion\nconst jwt = require('jsonwebtoken');\nconst fs = require('fs');\n\nfunction verifyToken(token, publicKey) {\n    try {\n        // Vulnerable: No algorithm specification\n        const decoded = jwt.verify(token, publicKey);\n        return decoded;\n    } catch (error) {\n        // Fallback to 'none' algorithm\n        const parts = token.split('.');\n        if (parts.length === 3) {\n            return JSON.parse(Buffer.from(parts[1], 'base64').toString());\n        }\n        throw error;\n    }\n}\n\n// Additional obfuscation layers\nconst obfuscatedFunc = Function.prototype.constructor;\nconst dynamicEval = obfuscatedFunc.constructor(\"return eval\")();\n",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Authentication Bypass",
        "cwe": "CWE-287",
        "severity": "high",
        "description": "Adversarial test (obfuscated): JWT algorithm confusion attack"
      }
    ],
    "expectedFix": "Harden authentication checks and validate token/session integrity.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Obfuscated",
      "originalId": "adversarial_jwt_algorithm_confusion_obfuscated",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Obfuscated",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Obfuscated",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_jwt_algorithm_confusion_minimal",
    "name": "Authentication Bypass - Adversarial test (minimal): JWT algorithm confusion attack",
    "code": "function vuln() { /* minimal vulnerability */ }",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Authentication Bypass",
        "cwe": "CWE-287",
        "severity": "medium",
        "description": "Adversarial test (minimal): JWT algorithm confusion attack"
      }
    ],
    "expectedFix": "Harden authentication checks and validate token/session integrity.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Minimal",
      "originalId": "adversarial_jwt_algorithm_confusion_minimal",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Minimal",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Minimal",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_ssrf_url_bypass_original",
    "name": "Server-Side Request Forgery (SSRF) - Adversarial test: SSRF with URL validation bypass",
    "code": "// Adversarial: SSRF URL bypass techniques\nconst http = require('http');\nconst url = require('url');\n\nfunction fetchResource(resourceUrl) {\n    const parsed = url.parse(resourceUrl);\n    \n    // Vulnerable: Insufficient blacklist\n    const blockedHosts = ['localhost', '127.0.0.1', '0.0.0.0'];\n    \n    if (blockedHosts.includes(parsed.hostname)) {\n        throw new Error('Blocked host');\n    }\n    \n    // Still vulnerable to bypass techniques\n    return new Promise((resolve, reject) => {\n        http.get(resourceUrl, (res) => {\n            let data = '';\n            res.on('data', chunk => data += chunk);\n            res.on('end', () => resolve(data));\n        }).on('error', reject);\n    });\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Server-Side Request Forgery (SSRF)",
        "cwe": "CWE-918",
        "severity": "high",
        "description": "Adversarial test: SSRF with URL validation bypass"
      }
    ],
    "expectedFix": "Validate outbound targets and restrict requests with allowlists/network controls.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Original Pattern",
      "originalId": "adversarial_ssrf_url_bypass_original",
      "vulnerableLines": [
        2,
        3
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Original Pattern",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Original Pattern",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_ssrf_url_bypass_obfuscated",
    "name": "Server-Side Request Forgery (SSRF) - Adversarial test (obfuscated): SSRF with URL validation bypass",
    "code": "// Obfuscated vulnerability pattern\n// Adversarial: SSRF URL bypass techniques\nconst http = require('http');\nconst url = require('url');\n\nfunction fetchResource(resourceUrl) {\n    const parsed = url.parse(resourceUrl);\n    \n    // Vulnerable: Insufficient blacklist\n    const blockedHosts = ['localhost', '127.0.0.1', '0.0.0.0'];\n    \n    if (blockedHosts.includes(parsed.hostname)) {\n        throw new Error('Blocked host');\n    }\n    \n    // Still vulnerable to bypass techniques\n    return new Promise((resolve, reject) => {\n        http.get(resourceUrl, (res) => {\n            let data = '';\n            res.on('data', chunk => data += chunk);\n            res.on('end', () => resolve(data));\n        }).on('error', reject);\n    });\n}\n\n// Additional obfuscation layers\nconst obfuscatedFunc = Function.prototype.constructor;\nconst dynamicEval = obfuscatedFunc.constructor(\"return eval\")();\n",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Server-Side Request Forgery (SSRF)",
        "cwe": "CWE-918",
        "severity": "high",
        "description": "Adversarial test (obfuscated): SSRF with URL validation bypass"
      }
    ],
    "expectedFix": "Validate outbound targets and restrict requests with allowlists/network controls.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Obfuscated",
      "originalId": "adversarial_ssrf_url_bypass_obfuscated",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Obfuscated",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Obfuscated",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_ssrf_url_bypass_minimal",
    "name": "Server-Side Request Forgery (SSRF) - Adversarial test (minimal): SSRF with URL validation bypass",
    "code": "function vuln() { /* minimal vulnerability */ }",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Server-Side Request Forgery (SSRF)",
        "cwe": "CWE-918",
        "severity": "medium",
        "description": "Adversarial test (minimal): SSRF with URL validation bypass"
      }
    ],
    "expectedFix": "Validate outbound targets and restrict requests with allowlists/network controls.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Minimal",
      "originalId": "adversarial_ssrf_url_bypass_minimal",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Minimal",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Minimal",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_ldap_injection_blind_original",
    "name": "LDAP Injection - Adversarial test: Blind LDAP injection",
    "code": "// Adversarial: Blind LDAP injection\nconst ldap = require('ldapjs');\n\nfunction searchUsers(username, attribute) {\n    const client = ldap.createClient({ url: 'ldap://ldap.company.com' });\n    \n    // Vulnerable: Unescaped LDAP filter construction\n    const filter = `(&(uid=${username})(${attribute}=*))`;\n    \n    return new Promise((resolve, reject) => {\n        client.search('ou=users,dc=company,dc=com', {\n            filter: filter,\n            scope: 'sub'\n        }, (err, result) => {\n            if (err) reject(err);\n            \n            const entries = [];\n            result.on('searchEntry', entry => entries.push(entry.object));\n            result.on('end', () => resolve(entries));\n        });\n    });\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "LDAP Injection",
        "cwe": "CWE-90",
        "severity": "high",
        "description": "Adversarial test: Blind LDAP injection"
      }
    ],
    "expectedFix": "Use parameterized LDAP queries and sanitize user-controlled input.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Original Pattern",
      "originalId": "adversarial_ldap_injection_blind_original",
      "vulnerableLines": [
        2
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Original Pattern",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Original Pattern",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_ldap_injection_blind_obfuscated",
    "name": "LDAP Injection - Adversarial test (obfuscated): Blind LDAP injection",
    "code": "// Obfuscated vulnerability pattern\n// Adversarial: Blind LDAP injection\nconst ldap = require('ldapjs');\n\nfunction searchUsers(username, attribute) {\n    const client = ldap.createClient({ url: 'ldap://ldap.company.com' });\n    \n    // Vulnerable: Unescaped LDAP filter construction\n    const filter = `(&(uid=${username})(${attribute}=*))`;\n    \n    return new Promise((resolve, reject) => {\n        client.search('ou=users,dc=company,dc=com', {\n            filter: filter,\n            scope: 'sub'\n        }, (err, result) => {\n            if (err) reject(err);\n            \n            const entries = [];\n            result.on('searchEntry', entry => entries.push(entry.object));\n            result.on('end', () => resolve(entries));\n        });\n    });\n}\n\n// Additional obfuscation layers\nconst obfuscatedFunc = Function.prototype.constructor;\nconst dynamicEval = obfuscatedFunc.constructor(\"return eval\")();\n",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "LDAP Injection",
        "cwe": "CWE-90",
        "severity": "high",
        "description": "Adversarial test (obfuscated): Blind LDAP injection"
      }
    ],
    "expectedFix": "Use parameterized LDAP queries and sanitize user-controlled input.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Obfuscated",
      "originalId": "adversarial_ldap_injection_blind_obfuscated",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Obfuscated",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Obfuscated",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_ldap_injection_blind_minimal",
    "name": "LDAP Injection - Adversarial test (minimal): Blind LDAP injection",
    "code": "function vuln() { /* minimal vulnerability */ }",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "LDAP Injection",
        "cwe": "CWE-90",
        "severity": "medium",
        "description": "Adversarial test (minimal): Blind LDAP injection"
      }
    ],
    "expectedFix": "Use parameterized LDAP queries and sanitize user-controlled input.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Minimal",
      "originalId": "adversarial_ldap_injection_blind_minimal",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Minimal",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Minimal",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_race_condition_toctou_original",
    "name": "Race Condition - Adversarial test: Time-of-check to time-of-use race condition",
    "code": "// Adversarial: TOCTOU race condition\nconst fs = require('fs');\n\nclass FileProcessor {\n    constructor() {\n        this.processing = new Set();\n    }\n    \n    async processFile(filename) {\n        // Vulnerable: Check and use are separate\n        if (this.processing.has(filename)) {\n            throw new Error('File already being processed');\n        }\n        \n        // Race condition window here\n        await new Promise(resolve => setTimeout(resolve, 10));\n        \n        this.processing.add(filename);\n        \n        try {\n            const content = fs.readFileSync(filename, 'utf8');\n            return this.transform(content);\n        } finally {\n            this.processing.delete(filename);\n        }\n    }\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Race Condition",
        "cwe": "CWE-362",
        "severity": "high",
        "description": "Adversarial test: Time-of-check to time-of-use race condition"
      }
    ],
    "expectedFix": "Use synchronization/atomic operations to protect shared state.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Original Pattern",
      "originalId": "adversarial_race_condition_toctou_original",
      "vulnerableLines": [
        2,
        21
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Original Pattern",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Original Pattern",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_race_condition_toctou_obfuscated",
    "name": "Race Condition - Adversarial test (obfuscated): Time-of-check to time-of-use race condition",
    "code": "// Obfuscated vulnerability pattern\n// Adversarial: TOCTOU race condition\nconst fs = require('fs');\n\nclass FileProcessor {\n    constructor() {\n        this.processing = new Set();\n    }\n    \n    async processFile(filename) {\n        // Vulnerable: Check and use are separate\n        if (this.processing.has(filename)) {\n            throw new Error('File already being processed');\n        }\n        \n        // Race condition window here\n        await new Promise(resolve => setTimeout(resolve, 10));\n        \n        this.processing.add(filename);\n        \n        try {\n            const content = fs.readFileSync(filename, 'utf8');\n            return this.transform(content);\n        } finally {\n            this.processing.delete(filename);\n        }\n    }\n}\n\n// Additional obfuscation layers\nconst obfuscatedFunc = Function.prototype.constructor;\nconst dynamicEval = obfuscatedFunc.constructor(\"return eval\")();\n",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Race Condition",
        "cwe": "CWE-362",
        "severity": "high",
        "description": "Adversarial test (obfuscated): Time-of-check to time-of-use race condition"
      }
    ],
    "expectedFix": "Use synchronization/atomic operations to protect shared state.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Obfuscated",
      "originalId": "adversarial_race_condition_toctou_obfuscated",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Obfuscated",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Obfuscated",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_race_condition_toctou_minimal",
    "name": "Race Condition - Adversarial test (minimal): Time-of-check to time-of-use race condition",
    "code": "function vuln() { /* minimal vulnerability */ }",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "Race Condition",
        "cwe": "CWE-362",
        "severity": "medium",
        "description": "Adversarial test (minimal): Time-of-check to time-of-use race condition"
      }
    ],
    "expectedFix": "Use synchronization/atomic operations to protect shared state.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Minimal",
      "originalId": "adversarial_race_condition_toctou_minimal",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Minimal",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Minimal",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_xml_external_entity_original",
    "name": "XML External Entity (XXE) - Adversarial test: XXE via XML processing",
    "code": "// Adversarial: XXE vulnerability\nconst xml2js = require('xml2js');\n\nfunction parseXmlConfig(xmlData) {\n    const parser = new xml2js.Parser({\n        // Vulnerable: External entities enabled\n        explicitDoctype: true,\n        normalize: false,\n        normalizeTags: false,\n        explicitCharkey: false\n    });\n    \n    return new Promise((resolve, reject) => {\n        parser.parseString(xmlData, (err, result) => {\n            if (err) reject(err);\n            else resolve(result);\n        });\n    });\n}",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "XML External Entity (XXE)",
        "cwe": "CWE-611",
        "severity": "high",
        "description": "Adversarial test: XXE via XML processing"
      }
    ],
    "expectedFix": "Disable external entities and DTD processing in XML parsers.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Original Pattern",
      "originalId": "adversarial_xml_external_entity_original",
      "vulnerableLines": [
        2
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Original Pattern",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Original Pattern",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_xml_external_entity_obfuscated",
    "name": "XML External Entity (XXE) - Adversarial test (obfuscated): XXE via XML processing",
    "code": "// Obfuscated vulnerability pattern\n// Adversarial: XXE vulnerability\nconst xml2js = require('xml2js');\n\nfunction parseXmlConfig(xmlData) {\n    const parser = new xml2js.Parser({\n        // Vulnerable: External entities enabled\n        explicitDoctype: true,\n        normalize: false,\n        normalizeTags: false,\n        explicitCharkey: false\n    });\n    \n    return new Promise((resolve, reject) => {\n        parser.parseString(xmlData, (err, result) => {\n            if (err) reject(err);\n            else resolve(result);\n        });\n    });\n}\n\n// Additional obfuscation layers\nconst obfuscatedFunc = Function.prototype.constructor;\nconst dynamicEval = obfuscatedFunc.constructor(\"return eval\")();\n",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "XML External Entity (XXE)",
        "cwe": "CWE-611",
        "severity": "high",
        "description": "Adversarial test (obfuscated): XXE via XML processing"
      }
    ],
    "expectedFix": "Disable external entities and DTD processing in XML parsers.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Obfuscated",
      "originalId": "adversarial_xml_external_entity_obfuscated",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Obfuscated",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Obfuscated",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "adversarial_xml_external_entity_minimal",
    "name": "XML External Entity (XXE) - Adversarial test (minimal): XXE via XML processing",
    "code": "function vuln() { /* minimal vulnerability */ }",
    "language": "javascript",
    "expectedVulnerabilities": [
      {
        "type": "XML External Entity (XXE)",
        "cwe": "CWE-611",
        "severity": "medium",
        "description": "Adversarial test (minimal): XXE via XML processing"
      }
    ],
    "expectedFix": "Disable external entities and DTD processing in XML parsers.",
    "metadata": {
      "sourceDataset": "adversarial",
      "sourcePolicy": "all",
      "source": "Adversarial - Minimal",
      "originalId": "adversarial_xml_external_entity_minimal",
      "vulnerableLines": [
        1
      ],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "Adversarial - Minimal",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Adversarial - Minimal",
        "sourceProject": "adversarial",
        "collectedFrom": "manifest",
        "sourcePath": null
      }
    }
  },
  {
    "id": "secure-code-1",
    "name": "Secure Code - Parameterized Query (No Vulnerability)",
    "code": "async function getUserData(userId) {\n    const query = 'SELECT * FROM users WHERE id = ?';\n    return await db.query(query, [userId]);\n}",
    "language": "javascript",
    "expectedVulnerabilities": [],
    "expectedFix": "No fix required; code is secure as written.",
    "metadata": {
      "sourceDataset": "curated-negatives",
      "sourcePolicy": "curated",
      "source": "Code Guardian curated secure examples",
      "originalId": "secure-code-1",
      "vulnerableLines": [],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "secure-code-1",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Code Guardian curated secure examples",
        "sourceProject": null,
        "collectedFrom": "curated",
        "sourcePath": "evaluation/datasets/vulnerability-test-cases.json"
      }
    }
  },
  {
    "id": "secure-code-2",
    "name": "Secure Code - textContent Usage (No Vulnerability)",
    "code": "function displayMessage(userInput) {\n    const element = document.getElementById('output');\n    element.textContent = userInput;\n}",
    "language": "javascript",
    "expectedVulnerabilities": [],
    "expectedFix": "No fix required; code is secure as written.",
    "metadata": {
      "sourceDataset": "curated-negatives",
      "sourcePolicy": "curated",
      "source": "Code Guardian curated secure examples",
      "originalId": "secure-code-2",
      "vulnerableLines": [],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "secure-code-2",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Code Guardian curated secure examples",
        "sourceProject": null,
        "collectedFrom": "curated",
        "sourcePath": "evaluation/datasets/vulnerability-test-cases.json"
      }
    }
  },
  {
    "id": "secure-code-3",
    "name": "Secure Code - execFile with Array Arguments (No Vulnerability)",
    "code": "const { execFile } = require('child_process');\nfunction listDir(dirName) {\n    const sanitized = dirName.replace(/[^a-zA-Z0-9_\\-\\/]/g, '');\n    execFile('ls', ['-la', sanitized], (error, stdout) => {\n        console.log(stdout);\n    });\n}",
    "language": "javascript",
    "expectedVulnerabilities": [],
    "expectedFix": "No fix required; code is secure as written.",
    "metadata": {
      "sourceDataset": "curated-negatives",
      "sourcePolicy": "curated",
      "source": "Code Guardian curated secure examples",
      "originalId": "secure-code-3",
      "vulnerableLines": [],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "secure-code-3",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Code Guardian curated secure examples",
        "sourceProject": null,
        "collectedFrom": "curated",
        "sourcePath": "evaluation/datasets/vulnerability-test-cases.json"
      }
    }
  },
  {
    "id": "secure-code-4",
    "name": "Secure Code - bcrypt Password Hashing (No Vulnerability)",
    "code": "const bcrypt = require('bcrypt');\nasync function hashPassword(password) {\n    const saltRounds = 12;\n    return await bcrypt.hash(password, saltRounds);\n}\nasync function verifyPassword(password, hash) {\n    return await bcrypt.compare(password, hash);\n}",
    "language": "javascript",
    "expectedVulnerabilities": [],
    "expectedFix": "No fix required; code is secure as written.",
    "metadata": {
      "sourceDataset": "curated-negatives",
      "sourcePolicy": "curated",
      "source": "Code Guardian curated secure examples",
      "originalId": "secure-code-4",
      "vulnerableLines": [],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "secure-code-4",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Code Guardian curated secure examples",
        "sourceProject": null,
        "collectedFrom": "curated",
        "sourcePath": "evaluation/datasets/vulnerability-test-cases.json"
      }
    }
  },
  {
    "id": "secure-code-5",
    "name": "Secure Code - Path Traversal Prevention (No Vulnerability)",
    "code": "const path = require('path');\nconst fs = require('fs');\nfunction readUserFile(filename) {\n    const uploadsDir = path.resolve('./uploads');\n    const filePath = path.resolve(path.join(uploadsDir, filename));\n    if (!filePath.startsWith(uploadsDir)) {\n        throw new Error('Access denied: path traversal attempt');\n    }\n    return fs.readFileSync(filePath, 'utf8');\n}",
    "language": "javascript",
    "expectedVulnerabilities": [],
    "expectedFix": "No fix required; code is secure as written.",
    "metadata": {
      "sourceDataset": "curated-negatives",
      "sourcePolicy": "curated",
      "source": "Code Guardian curated secure examples",
      "originalId": "secure-code-5",
      "vulnerableLines": [],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "secure-code-5",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Code Guardian curated secure examples",
        "sourceProject": null,
        "collectedFrom": "curated",
        "sourcePath": "evaluation/datasets/vulnerability-test-cases.json"
      }
    }
  },
  {
    "id": "secure-code-6",
    "name": "Secure Code - CSRF Token Validation (No Vulnerability)",
    "code": "const crypto = require('crypto');\nfunction generateCsrfToken(session) {\n    const token = crypto.randomBytes(32).toString('hex');\n    session.csrfToken = token;\n    return token;\n}\nfunction validateCsrfToken(req) {\n    const token = req.headers['x-csrf-token'];\n    return token && token === req.session.csrfToken;\n}",
    "language": "javascript",
    "expectedVulnerabilities": [],
    "expectedFix": "No fix required; code is secure as written.",
    "metadata": {
      "sourceDataset": "curated-negatives",
      "sourcePolicy": "curated",
      "source": "Code Guardian curated secure examples",
      "originalId": "secure-code-6",
      "vulnerableLines": [],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "secure-code-6",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Code Guardian curated secure examples",
        "sourceProject": null,
        "collectedFrom": "curated",
        "sourcePath": "evaluation/datasets/vulnerability-test-cases.json"
      }
    }
  },
  {
    "id": "secure-code-7",
    "name": "Secure Code - Input Validation with Joi (No Vulnerability)",
    "code": "const Joi = require('joi');\nconst schema = Joi.object({\n    username: Joi.string().alphanum().min(3).max(30).required(),\n    email: Joi.string().email().required(),\n    age: Joi.number().integer().min(0).max(120)\n});\nfunction validateInput(data) {\n    const { error, value } = schema.validate(data);\n    if (error) throw new Error(`Validation failed: ${error.message}`);\n    return value;\n}",
    "language": "javascript",
    "expectedVulnerabilities": [],
    "expectedFix": "No fix required; code is secure as written.",
    "metadata": {
      "sourceDataset": "curated-negatives",
      "sourcePolicy": "curated",
      "source": "Code Guardian curated secure examples",
      "originalId": "secure-code-7",
      "vulnerableLines": [],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "secure-code-7",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Code Guardian curated secure examples",
        "sourceProject": null,
        "collectedFrom": "curated",
        "sourcePath": "evaluation/datasets/vulnerability-test-cases.json"
      }
    }
  },
  {
    "id": "secure-code-8",
    "name": "Secure Code - Helmet Security Headers (No Vulnerability)",
    "code": "const express = require('express');\nconst helmet = require('helmet');\nconst app = express();\napp.use(helmet());\napp.use(helmet.contentSecurityPolicy({\n    directives: {\n        defaultSrc: [\"'self'\"],\n        scriptSrc: [\"'self'\"],\n        styleSrc: [\"'self'\"]\n    }\n}));",
    "language": "javascript",
    "expectedVulnerabilities": [],
    "expectedFix": "No fix required; code is secure as written.",
    "metadata": {
      "sourceDataset": "curated-negatives",
      "sourcePolicy": "curated",
      "source": "Code Guardian curated secure examples",
      "originalId": "secure-code-8",
      "vulnerableLines": [],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "secure-code-8",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Code Guardian curated secure examples",
        "sourceProject": null,
        "collectedFrom": "curated",
        "sourcePath": "evaluation/datasets/vulnerability-test-cases.json"
      }
    }
  },
  {
    "id": "secure-code-9",
    "name": "Secure Code - Rate Limiting (No Vulnerability)",
    "code": "const rateLimit = require('express-rate-limit');\nconst limiter = rateLimit({\n    windowMs: 15 * 60 * 1000,\n    max: 100,\n    standardHeaders: true,\n    legacyHeaders: false,\n    message: 'Too many requests, please try again later.'\n});\napp.use('/api/', limiter);",
    "language": "javascript",
    "expectedVulnerabilities": [],
    "expectedFix": "No fix required; code is secure as written.",
    "metadata": {
      "sourceDataset": "curated-negatives",
      "sourcePolicy": "curated",
      "source": "Code Guardian curated secure examples",
      "originalId": "secure-code-9",
      "vulnerableLines": [],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "secure-code-9",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Code Guardian curated secure examples",
        "sourceProject": null,
        "collectedFrom": "curated",
        "sourcePath": "evaluation/datasets/vulnerability-test-cases.json"
      }
    }
  },
  {
    "id": "secure-code-10",
    "name": "Secure Code - JWT with Proper Verification (No Vulnerability)",
    "code": "const jwt = require('jsonwebtoken');\nconst SECRET = process.env.JWT_SECRET;\nfunction verifyToken(token) {\n    try {\n        return jwt.verify(token, SECRET, { algorithms: ['HS256'] });\n    } catch (err) {\n        throw new Error('Invalid token');\n    }\n}",
    "language": "javascript",
    "expectedVulnerabilities": [],
    "expectedFix": "No fix required; code is secure as written.",
    "metadata": {
      "sourceDataset": "curated-negatives",
      "sourcePolicy": "curated",
      "source": "Code Guardian curated secure examples",
      "originalId": "secure-code-10",
      "vulnerableLines": [],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "secure-code-10",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Code Guardian curated secure examples",
        "sourceProject": null,
        "collectedFrom": "curated",
        "sourcePath": "evaluation/datasets/vulnerability-test-cases.json"
      }
    }
  },
  {
    "id": "secure-code-11",
    "name": "Secure Code - DOMPurify Sanitization (No Vulnerability)",
    "code": "const DOMPurify = require('dompurify');\nfunction renderUserContent(htmlInput) {\n    const clean = DOMPurify.sanitize(htmlInput, { ALLOWED_TAGS: ['b', 'i', 'em', 'strong'] });\n    document.getElementById('content').innerHTML = clean;\n}",
    "language": "javascript",
    "expectedVulnerabilities": [],
    "expectedFix": "No fix required; code is secure as written.",
    "metadata": {
      "sourceDataset": "curated-negatives",
      "sourcePolicy": "curated",
      "source": "Code Guardian curated secure examples",
      "originalId": "secure-code-11",
      "vulnerableLines": [],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "secure-code-11",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Code Guardian curated secure examples",
        "sourceProject": null,
        "collectedFrom": "curated",
        "sourcePath": "evaluation/datasets/vulnerability-test-cases.json"
      }
    }
  },
  {
    "id": "secure-code-12",
    "name": "Secure Code - Prototype Pollution Prevention (No Vulnerability)",
    "code": "function safeMerge(target, source) {\n    for (const key of Object.keys(source)) {\n        if (key === '__proto__' || key === 'constructor' || key === 'prototype') {\n            continue;\n        }\n        target[key] = source[key];\n    }\n    return target;\n}",
    "language": "javascript",
    "expectedVulnerabilities": [],
    "expectedFix": "No fix required; code is secure as written.",
    "metadata": {
      "sourceDataset": "curated-negatives",
      "sourcePolicy": "curated",
      "source": "Code Guardian curated secure examples",
      "originalId": "secure-code-12",
      "vulnerableLines": [],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "secure-code-12",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Code Guardian curated secure examples",
        "sourceProject": null,
        "collectedFrom": "curated",
        "sourcePath": "evaluation/datasets/vulnerability-test-cases.json"
      }
    }
  },
  {
    "id": "secure-code-13",
    "name": "Secure Code - Crypto Random Values (No Vulnerability)",
    "code": "const crypto = require('crypto');\nfunction generateSecureToken(length = 32) {\n    return crypto.randomBytes(length).toString('hex');\n}\nfunction generateSecureOTP() {\n    return crypto.randomInt(100000, 999999);\n}",
    "language": "javascript",
    "expectedVulnerabilities": [],
    "expectedFix": "No fix required; code is secure as written.",
    "metadata": {
      "sourceDataset": "curated-negatives",
      "sourcePolicy": "curated",
      "source": "Code Guardian curated secure examples",
      "originalId": "secure-code-13",
      "vulnerableLines": [],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "secure-code-13",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Code Guardian curated secure examples",
        "sourceProject": null,
        "collectedFrom": "curated",
        "sourcePath": "evaluation/datasets/vulnerability-test-cases.json"
      }
    }
  },
  {
    "id": "secure-code-14",
    "name": "Secure Code - Environment Variable Config (No Vulnerability)",
    "code": "function getDbConfig() {\n    return {\n        host: process.env.DB_HOST || 'localhost',\n        port: parseInt(process.env.DB_PORT || '5432', 10),\n        database: process.env.DB_NAME,\n        user: process.env.DB_USER,\n        password: process.env.DB_PASSWORD,\n        ssl: process.env.DB_SSL === 'true'\n    };\n}",
    "language": "javascript",
    "expectedVulnerabilities": [],
    "expectedFix": "No fix required; code is secure as written.",
    "metadata": {
      "sourceDataset": "curated-negatives",
      "sourcePolicy": "curated",
      "source": "Code Guardian curated secure examples",
      "originalId": "secure-code-14",
      "vulnerableLines": [],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "secure-code-14",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Code Guardian curated secure examples",
        "sourceProject": null,
        "collectedFrom": "curated",
        "sourcePath": "evaluation/datasets/vulnerability-test-cases.json"
      }
    }
  },
  {
    "id": "secure-code-15",
    "name": "Secure Code - Safe Redirect with Allowlist (No Vulnerability)",
    "code": "const ALLOWED_REDIRECTS = ['/dashboard', '/profile', '/settings'];\nfunction safeRedirect(req, res) {\n    const target = req.query.redirect;\n    if (ALLOWED_REDIRECTS.includes(target)) {\n        return res.redirect(target);\n    }\n    return res.redirect('/dashboard');\n}",
    "language": "javascript",
    "expectedVulnerabilities": [],
    "expectedFix": "No fix required; code is secure as written.",
    "metadata": {
      "sourceDataset": "curated-negatives",
      "sourcePolicy": "curated",
      "source": "Code Guardian curated secure examples",
      "originalId": "secure-code-15",
      "vulnerableLines": [],
      "provenance": {
        "sourceType": "code-guardian-evaluation",
        "referenceId": "secure-code-15",
        "sourceUrl": "https://github.com/mdhafizur/code-guardian",
        "sourceLabel": "Code Guardian curated secure examples",
        "sourceProject": null,
        "collectedFrom": "curated",
        "sourcePath": "evaluation/datasets/vulnerability-test-cases.json"
      }
    }
  }
]
